<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Peasec Threat Intelligence Platform</title>
    <link rel="stylesheet" href="{{ url_for('static',filename = 'bootstrap/bootstrap.min.css')}}">
    <link rel="stylesheet" href="{{ url_for('static',filename = 'custom/styles.css')}}">
    <script src="{{ url_for('static',filename = 'bootstrap/jquery.min.js') }}"></script>
    <script src="{{ url_for('static',filename = 'bootstrap/popper.min.js') }}"></script>
    <script src="{{ url_for('static',filename = 'bootstrap/bootstrap.min.js') }}"></script>
    <script src="{{ url_for('static',filename = 'custom/malware-family/update_malwarefamily.js') }}"></script>
</head>
<body>

<div class="container-fluid">
{#header section#}
    <div class="row">
            <!--Navbar-->
            <nav class="navbar navbar-expand-lg bg-light  navbar-light fixed-top " role="navigation">
                <a class="navbar-brand" href="#">
                    <img src="{{ url_for('static',filename='images/peaseclogo.png') }}" width="30" height="30" class="d-inline-block align-top" alt="">
                    PEASEC Threat Intelligence Platform</a>
                <div class="navbar-collapse">
                    <ul class=" nav nav-pills" id="myTab" role="tablist">
                    <li class="nav-item">
                      <a class="nav-link" href="{{ url_for('home') }}">Home</a>
                    </li>
                  </ul>
                </div>
                    <div class="clearfix mr-lg-5 pr-lg-5">
                        <ul class="nav navbar-nav mr-lg-auto float-lg-right " >
                          <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button"
                               aria-haspopup="true" aria-expanded="false"><span class="glyphicons glyphicons-user">
                            </span>{{ session['user'] }}</a>
                            <div class="dropdown-menu">
                              <a class="dropdown-item" href="{{ url_for('logout') }}">Logout</a>
                            </div>
                          </li>
                        </ul>
                    </div>
            </nav>
            <!--/.Navbar-->
       </div>
{#    body content section#}
    <div class="row attkpat_bodycontent ">
    <!-- update main object -->
        <div class="col-lg-4">
            <div class="card">
                <div class="card-header">{{ data.type }}</div>
                <div class="card-body">
                    <div class="container">
                        <form role="form" method="POST" id="update_malwarefamilyform">
                            <div class="form-group row">
                                <label class="col-lg-3 col-form-label" >Name:</label>
                                <div class="col-lg-9">

                                    <label class="col-form-label">{{ namedata.result }}</label>
                                </div>
                            </div>
                            <div class="form-group row">
                                <label class="col-lg-3 col-form-label" >Aliases:</label>
                                <div class="col-lg-9">
                                    <select  class="form-control form-control-sm" readonly multiple>
                                     {% for ele in aliasesdata %}
                                            <option>{{ ele.result }}</option>
                                        {% endfor %}
                                </select>

                                </div>
                            </div>
                            <div class="form-group row">

                                <label class="col-lg-3 col-form-label" >Labels:</label>
                                <div class="col-lg-9" >
                                    <input type="hidden"  name="id" value="{{ data.id }}">
                                    <select  class="form-control form-control-sm" multiple id="labels">
                          <option>Choose an option</option>
                          <option value="adware">adware</option>
                          <option value="appender">appender</option>
                          <option value="backdoor">backdoor</option>
                          <option value="boot-sector-virus">boot-sector-virus</option>
                          <option value="bot">bot</option>
                          <option value="cavity-filler">cavity-filler</option>
                          <option value="clicker">clicker</option>
                          <option value="companion-virus">companion-virus</option>
                          <option value="data-diddler">data-diddler</option>
                          <option value="ddos">ddos</option>
                          <option value="downloader">downloader</option>
                          <option value="dropper">dropper</option>
                          <option value="exploit-kit">exploit-kit</option>
                          <option value="file-infector-virus">file-infector-virus</option>
                          <option value="file-less">file-less</option>
                          <option value="fork-bomb">fork-bomb</option>
                          <option value="greyware">greyware</option>
                          <option value="implant">implant</option>
                          <option value="keylogger">keylogger</option>
                          <option value="kleptographic-worm">kleptographic-worm</option>
                          <option value="macro-virus">macro-virus</option>
                          <option value="malware-as-a-service">malware-as-a-service</option>
                          <option value="mass-mailer">mass-mailer</option>
                          <option value="metamorphic-virus">metamorphic-virus</option>
                          <option value="mid-infector">mid-infector</option>
                          <option value="mobile-code">mobile-code</option>
                          <option value="multipartite-virus">multipartite-virus</option>
                          <option value="parental-control">parental-control</option>
                          <option value="password-stealer">password-stealer</option>
                          <option value="polymorphic-virus">polymorphic-virus</option>
                          <option value="premium-dialer-smser">premium-dialer-smser</option>
                          <option value="prepender">prepender</option>
                          <option value="ransomware">ransomware</option>
                          <option value="remote-access-trojan">remote-access-trojan</option>
                          <option value="resource-exploiter">resource-exploiter</option>
                          <option value="rogue-security-software">rogue-security-software</option>
                          <option value="rootkit">rootkit</option>
                          <option value="scareware">scareware</option>
                          <option value="screen-capture">screen-capture</option>
                          <option value="security-assessment-tools">security-assessment-tool</option>
                          <option value="shellcode">shellcode</option>
                          <option value="spyware">spyware</option>
                          <option value="trackware">trackware</option>
                          <option value="trojan">trojan</option>
                          <option value="virus">virus</option>
                          <option value="web-bug">web-bug</option>
                          <option value="worm">worm</option>
                      </select>
                                    <input type="hidden" name="labels" id="labels_final" value="{{ data.labels }}">
                                    <input type="hidden" name="created_by" value="{{ session['user'] }}">
                                    <small id="labelsHelpBlock" class="form-text text-muted">
                                Previously chose values are <b>{{ data.labels }}</b>.If you want to update it, choose the values from the dropdown above.
                          </small>
                                </div>
                            </div>
                            <div class="form-group row">
                                <label class="col-lg-3 col-form-label " >Description:</label>
                                <div class="col-lg-9">
                                    <textarea class="form-control form-control-sm" rows="4" name="desc">{{ data.description }}</textarea>
                                </div>
                            </div>
                            <div class="form-group row">
                                <label class="col-lg-3 col-form-label " >Common strings:</label>
                                <div class="col-lg-9">
                                    <input type="text" class="form-control form-control-sm" name="comm_strings" value="{{ data.commstrings }}">
                                </div>
                            </div>
{#                            <div class="form-group row">#}
{#                                <label class="col-lg-3 col-form-label " >Common capabilities:</label>#}
{#                                <div class="col-lg-9">#}
{#                                    <select class="form-control form-control-sm" multiple id="comm_capabilities">#}
{#                                        <option> Choose an option </option>#}
{#                                        {% for element in commcap %}#}
{#                                        <option value=""></option>#}
{#                                        {% endfor %}#}
{#                                    </select>#}
{#                                <input type="hidden" name="comm_capabilities" id="comm_capabilities_final">#}
{#                                </div>#}
{#                            </div>#}
                            <div class="form-group row">
                                <label class="col-lg-3 col-form-label " >Common code references:</label>
                                <div class="col-lg-9">
                                    <select class="form-control form-control-sm" multiple id="comm_coderefs">
                                        <option> Choose an option </option>
                                        {% for ele in refartifactdata %}
                                        <option value="{{ ele.id }}">{{ ele.id }}--{{ ele.name }}</option>
                                        {% endfor %}
                                    </select>
                                <small id="labelsHelpBlock" class="form-text text-muted">
                                Previously chosen values are <b>{{ data.common_coderefs }}</b>.If you want to update it, choose the values from the dropdown above.
                          </small>
                                <input type="hidden" name="comm_coderefs" value="{{ data.common_coderefs }}" id="comm_coderefs_final">
                                </div>
                            </div>
                            <div class="form-group row">
                                <label class="col-lg-3 col-form-label " >Common behavior references:</label>
                                <div class="col-lg-9">
                                    <select class="form-control form-control-sm" multiple id="comm_behaviorrefs">
                                        <option> Choose an option </option>
                                        {% for ele in behavrefsdata %}
                                        <option value="{{ ele.name}}">{{ ele.id }}--{{ ele.name }}</option>
                                        {% endfor %}
                                    </select>
                                <small id="labelsHelpBlock" class="form-text text-muted">
                                Previously chosen values are <b>{{ data.common_behaviorrefs }}</b>.If you want to update it, choose the values from the dropdown above.
                          </small>
                                <input type="hidden" name="comm_behaviorrefs" value="{{ data.common_behaviorrefs }}" id="comm_behaviorrefs_final">
                                </div>
                            </div>
                            <div class="form-group row">
                                <label class="col-lg-3 col-form-label " >References:</label>
                                <div class="col-lg-9">
                                    <select class="form-control form-control-sm" multiple id="references">
                                        <option> Choose an option </option>
                                        {% for ele in extrefdata %}
                                        <option value="{{ ele.id }}">{{ ele.id }}--{{ ele.name }}</option>
                                        {% endfor %}
                                    </select>
                                <small id="labelsHelpBlock" class="form-text text-muted">
                                Previously chosen values are <b>{{ data.references }}</b>.If you want to update it, choose the values from the dropdown above.
                          </small>
                                <input type="hidden" name="references" id="references_final">
                                </div>
                            </div>
                            <div class="form-group row">
                                <div class="offset-lg-4 col-lg-8">
                                    <button type="button" class="btn btn-sm btn-secondary" id="update_malwarefamily" >Update</button>
                                    <button type="reset" class="btn btn-sm btn-light">Reset</button>
                                </div>
                            </div>
                        </form>
                        <div class="alert alert-success" id="success-alert1">
                            <button type="button" class="close" data-dismiss="alert">x</button>
                            <strong>Success! </strong>
                            Data has been updated.
                        </div>
                        <div class="alert alert-danger" id="error-alert1">
                            <button type="button" class="close" data-dismiss="alert">x</button>
                            <strong>Error! </strong>
                            Data was not updated :(
                        </div>
            </div>
                </div>

            </div>

        </div>
        <div class="col-lg-4">
        <!-- Add External reference -->
            <div class="card">
                <div class="card-header">1. External References</div>
                <div class="card-body">
                    <div class="container">
                        <form role="form" id="ext_refform" method="POST">
                            <div class="form-group row">
                                <label class="col-lg-3 col-form-label" >Source name:</label>
                                <div class="col-lg-9">
                                    <input type="text" class="form-control form-control-sm" name="extref_srcname">
                                    <input type="hidden" name="ref_id" value="{{ data.id }}">
                                    <input type="hidden"  name="ref_type" value="{{ data.type }}">
                                    <input type="hidden" name="hash_type" >
                                    <input type="hidden" name="hash_value">
                                    <input type="hidden" name="created_by" value="{{ session['user'] }}">
                                </div>
                            </div>
                            <div class="form-group row">
                                <label class="col-lg-3 col-form-label" >Description:</label>
                                <div class="col-lg-9">
                                    <textarea class="form-control form-control-sm" rows="3" name="extref_desc"></textarea>
                                </div>
                            </div>
                            <div class="form-group row">
                                <label class="col-lg-3 col-form-label" >URL:</label>
                                <div class="col-lg-9">
                                    <input type="text" class="form-control form-control-sm" id="extUrl" name="extref_url" >
                                </div>
                            </div>
                            <div class="form-group row">
                                <label class="col-lg-3 col-form-label" >External Id:</label>
                                <div class="col-lg-9">
                                    <input type="text" class="form-control form-control-sm" name="extref_extid">
                                </div>
                            </div>
                            <div class="form-group row">
                                <div class="offset-lg-3 col-lg-9">
                                    <input type="submit" class="btn btn-sm btn-secondary" id="add_extref" value="Add">
                                    <input type="reset" class="btn btn-sm btn-light" value="Reset">
                                </div>
                            </div>
                        </form>
                        <div class="alert alert-success" id="success-alert2">
                            <button type="button" class="close" data-dismiss="alert">x</button>
                            <strong>Success! </strong>
                            Data has been updated.
                        </div>
                        <div class="alert alert-danger" id="error-alert2">
                            <button type="button" class="close" data-dismiss="alert">x</button>
                            <strong>Error! </strong>
                            Data was not updated :(
                        </div>
                    </div>
                </div>
            </div>
        <!-- Add Name -->
            <div class="card mt-1">
                <div class="card-header">2. Name</div>
                <div class="card-body">
                    <div class="container">
                        <form method="POST" id="nameform" role="form" >
                            <div class="form-group row">
                                <label class="col-lg-4 col-form-label" >Value:</label>
                                <div class="col-lg-8">
                                <input type="text" class="form-control form-control-sm" name="name_value">
                                    <input type="hidden" name="id" value="{{ namedata.id }}">
                                  <input type="hidden" class="form-control form-control-sm" name="obj_id" value="{{ data.id }}">
                                  <input type="hidden" class="form-control form-control-sm" name="obj_type" value="{{ data.type }}">
                                  <input type="hidden" name="created_by" value="{{ session['user'] }}">
                              </div>
                             </div>
                            <div class="form-group row">
                                <label class="col-lg-4 col-form-label" >Source:</label>
                                <div class="col-lg-8">
                                    <select class="form-control form-control-sm" name="source">
                                        <option value="0"> Choose an option </option>
                                        {% for ele in extrefdata %}
                                        <option value="{{ ele.id }}">{{ ele.id }}--{{ ele.name }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>
                            <div class="form-group row">
                                <label class="col-lg-4 col-form-label" >Confidence:</label>
                                <div class="col-lg-8">
                                    <input type="number" class="form-control form-control-sm" name="confidence">
                                </div>
                            </div>
                            <div class="form-group row">
                                <div class="offset-lg-4 col-lg-8">
                                    <button type="button" class="btn btn-sm btn-secondary" id="submit_name" >Update</button>
                                    <button type="reset" class="btn btn-sm btn-light">Reset</button>
                                </div>
                            </div>
                    </form>
                        <div class="alert alert-success" id="success-alert3">
                            <button type="button" class="close" data-dismiss="alert">x</button>
                            <strong>Success! </strong>
                            Data has been added.
                        </div>
                        <div class="alert alert-danger" id="error-alert3">
                            <button type="button" class="close" data-dismiss="alert">x</button>
                            <strong>Error! </strong>
                            Data was not updated :(
                        </div>
                    </div>
                </div>

            </div>
        </div>
        <div class="col-lg-4">
        <!-- Aliases -->
            <div class="card">
                <div class="card-header">3. Aliases</div>
                <div class="card-body">
                    <div class="container">
                        <form method="POST" id="aliasesform" role="form" >
                            <div class="form-group row">
                                <label class="col-lg-4 col-form-label" >Value:</label>
                                <div class="col-lg-8">
                                <input type="text" class="form-control form-control-sm" name="name_value">
                                  <input type="hidden" class="form-control form-control-sm" name="obj_id" value="{{ data.id }}">
                                  <input type="hidden" class="form-control form-control-sm" name="obj_type" value="{{ data.type }}">
                                  <input type="hidden" name="created_by" value="{{ session['user'] }}">
                              </div>
                             </div>
                            <div class="form-group row">
                                <label class="col-lg-4 col-form-label" >Source:</label>
                                <div class="col-lg-8">
                                    <select class="form-control form-control-sm" name="source">
                                        <option value="0"> Choose an option </option>
                                        {% for ele in extrefdata %}
                                        <option value="{{ ele.id }}">{{ ele.id }}--{{ ele.name }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>
                            <div class="form-group row">
                                <label class="col-lg-4 col-form-label" >Confidence:</label>
                                <div class="col-lg-8">
                                    <input type="number" class="form-control form-control-sm" min="1" max="100" name="confidence">
                                </div>
                            </div>
                            <div class="form-group row">
                                <div class="offset-lg-4 col-lg-8">
                                    <button type="button" class="btn btn-sm btn-secondary" id="submit_aliases" >Add</button>
                                    <button type="reset" class="btn btn-sm btn-light">Reset</button>
                                </div>
                            </div>
                    </form>
                        <div class="alert alert-success" id="success-alert4">
                            <button type="button" class="close" data-dismiss="alert">x</button>
                            <strong>Success! </strong>
                            Data has been added.
                        </div>
                        <div class="alert alert-danger" id="error-alert4">
                            <button type="button" class="close" data-dismiss="alert">x</button>
                            <strong>Error! </strong>
                            Data was not updated :(
                        </div>
                    </div>
                </div>

            </div>
        <!-- Add Field data -->
            <div class="card mt-1">
                <div class="card-header">4. Field data</div>
                <div class="card-body">
                    <div class="container">
                        <form method="POST" id="fielddataform" role="form" >
                            <div class="form-group row">
                                <label class="col-lg-4 col-form-label" >Delivery vectors:</label>
                                <div class="col-lg-8">
                                <select class="form-control form-control-sm" name="delivery_vectors" multiple id="dev_vectors">
                                    <option value="None">Choose an option</option>
                                    <option value="active-attacker">active-attacker</option>
                                    <option value="auto-executing-media">auto-executing-media</option>
                                    <option value="downloader">downloader</option>
                                    <option value="dropper">dropper</option>
                                    <option value="email-attachment">email-attachment</option>
                                    <option value="exploit-kit-landing-page">exploit-kit-landing-page</option>
                                    <option value="fake-website">fake-website</option>
                                    <option value="janitor-attack">janitor-attack</option>
                                    <option value="malicious-iframes">malicious-iframes</option>
                                    <option value="malvertising">malvertising</option>
                                    <option value="media-baiting">media-baiting</option>
                                    <option value="pharming">pharming</option>
                                    <option value="phishing">phishing</option>
                                    <option value="trojanized-link">trojanized-link</option>
                                    <option value="trojanized-software">trojanized-software</option>
                                    <option value="usb-cable-syncing">usb-cable-syncing</option>
                                    <option value="watering-hole">watering-hole</option>
                                </select>
                                    <input type="hidden" name="delivery_vectors" id="dev_vectors_final">
                                  <input type="hidden" class="form-control form-control-sm" name="obj_id" value="{{ data.id }}">
                                  <input type="hidden" class="form-control form-control-sm" name="obj_type" value="{{ data.type }}">
                                  <input type="hidden" name="created_by" value="{{ session['user'] }}">
                              </div>
                             </div>
                            <div class="form-group row">
                                <label class="col-lg-4 col-form-label" >First seen:</label>
                                <div class="col-lg-8">
                                    <input type="datetime-local" name="first_seen" class="form-control form-control-sm">
                                </div>
                            </div>
                            <div class="form-group row">
                                <label class="col-lg-4 col-form-label" >Last seen:</label>
                                <div class="col-lg-8">
                                    <input type="datetime-local" name="last_seen" class="form-control form-control-sm">
                                </div>
                            </div>
                            <div class="form-group row">
                                <div class="offset-lg-4 col-lg-8">
                                    <button type="button" class="btn btn-sm btn-secondary" id="submit_fielddata" >Add</button>
                                    <button type="reset" class="btn btn-sm btn-light">Reset</button>
                                </div>
                            </div>
                    </form>
                        <div class="alert alert-success" id="success-alert5">
                            <button type="button" class="close" data-dismiss="alert">x</button>
                            <strong>Success! </strong>
                            Data has been added.
                        </div>
                        <div class="alert alert-danger" id="error-alert5">
                            <button type="button" class="close" data-dismiss="alert">x</button>
                            <strong>Error! </strong>
                            Data was not updated :(
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
    <div class="row mt-2">
        <div class="col-lg-4">
        <!-- Add Refined capabilities -->
            <div class="card">
                <div class="card-header">5. Refined capability</div>
                <div class="card-body">
                    <div class="container">
                        <form method="POST" id="refinedcapabilityform" role="form" >
                            <div class="form-group row">
                                <label class="col-lg-4 col-form-label" >Name:</label>
                                <div class="col-lg-8">
                                <select class="form-control form-control-sm" name="nm">
                                    <option value="None">Choose an option</option>
                                    <option value="access-control-degradation">access-control-degradation</option>
                                    <option value="anti-disassembly">anti-disassembly</option>
                                    <option value="anti-emulation">anti-emulation</option>
                                    <option value="anti-memory-forensics">anti-memory-forensics</option>
                                    <option value="anti-sandbox">anti-sandbox</option>
                                    <option value="anti-virus-evasion">anti-virus-evasion</option>
                                    <option value="anti-vm">anti-vm</option>
                                    <option value="authentication-credentials-theft">authentication-credentials-theft</option>
                                    <option value="clean-traces-of-infection">clean-traces-of-infection</option>
                                    <option value="communicate-with-c2-server">communicate-with-c2-server</option>
                                    <option value="compromise-data-availability">compromise-data-availability</option>
                                    <option value="compromise-system-availability">compromise-system-availability</option>
                                    <option value="consume-system-resources">consume-system-resources</option>
                                    <option value="continuous-execution">continuous-execution</option>
                                    <option value="data-integrity-violation">data-integrity-violation</option>
                                    <option value="data-obfuscation">data-obfuscation</option>
                                    <option value="data-staging">data-staging</option>
                                    <option value="determine-c2-server">determine-c2-server</option>
                                    <option value="email-spam">email-spam</option>
                                    <option value="ensure-compatibility">ensure-compatibility</option>
                                    <option value="environment-awareness">environment-awareness</option>
                                    <option value="file-infection">file-infection</option>
                                    <option value="hide-artifacts">hide-artifacts</option>
                                    <option value="hide-executing-code">hide-executing-code</option>
                                    <option value="hide-non-executing-code">hide-non-executing-code</option>
                                    <option value="host-configuration-probing">host-configuration-probing</option>
                                    <option value="information-gathering-for-improvement">information-gathering-for-improvement</option>
                                    <option value="input-peripheral-capture">input-peripheral-capture</option>
                                    <option value="install-other-components">install-other-components</option>
                                    <option value="local-machine-control">local-machine-control</option>
                                    <option value="network-environment-probing">network-environment-probing</option>
                                    <option value="os-security-feature-degradation">os-security-feature-degradation</option>
                                    <option value="output-peripheral-capture">output-peripheral-capture</option>
                                    <option value="physical-entity-destruction">physical-entity-destruction</option>
                                    <option value="prevent-artifact-access">prevent-artifact-access</option>
                                    <option value="prevent-artifact-deletion">prevent-artifact-deletion</option>
                                    <option value="remote-machine-access">remote-machine-access</option>
                                    <option value="remote-machine-infection">remote-machine-infection</option>
                                    <option value="security-software-degradation">security-software-degradation</option>
                                    <option value="security-software-evasion">security-software-evasion</option>
                                    <option value="self-modification">self-modification</option>
                                    <option value="service-provider-security-feature-degradation">service-provider-security-feature-degradation</option>
                                    <option value="stored-information-theft">stored-information-theft</option>
                                    <option value="system-interface-data-capture">system-interface-data-capture</option>
                                    <option value="system-operational-integrity-violation">system-operational-integrity-violation</option>
                                    <option value="system-re-infection">system-re-infection</option>
                                    <option value="system-state-data-capture">system-state-data-capture</option>
                                    <option value="system-update-degradation">system-update-degradation</option>
                                    <option value="user-data-theft">user-data-theft</option>
                                    <option value="virtual-entity-destruction">virtual-entity-destruction</option>
                                </select>
                                  <input type="hidden" class="form-control form-control-sm" name="obj_id" value="{{ data.id }}">
                                  <input type="hidden" class="form-control form-control-sm" name="obj_type" value="{{ data.type }}">
                                  <input type="hidden" name="created_by" value="{{ session['user'] }}">
                              </div>
                             </div>
                            <div class="form-group row">
                                <label class="col-lg-4 col-form-label" >Description:</label>
                                <div class="col-lg-8">
                                    <textarea class="form-control form-control-sm" rows="4" name="desc"></textarea>
                                </div>
                            </div>
                            <div class="form-group row">
                                <label class="col-lg-4 col-form-label" >Attributes:</label>
                                <div class="col-lg-4">
                                    <select class="form-control form-control-sm " id="attr_key"  name="attr_key">
                                        <option> Choose an attribute</option>
                                        <option value="applicable-platform">applicable-platform</option>
                                        <option value="archive-type">archive-type</option>
                                        <option value="autonomy">autonomy</option>
                                        <option value="backdoor-type">backdoor-type</option>
                                        <option value="cryptocurrency-type">cryptocurrency-type</option>
                                        <option value="encryption-algorithm">encryption-algorithm</option>
                                        <option value="erasure-scope">erasure-scope</option>
                                        <option value="file-infection-type">file-infection-type</option>
                                        <option value="file-modification-type">file-modification-type</option>
                                        <option value="file-type">file-type</option>
                                        <option value="frequency">frequency</option>
                                        <option value="infection-targeting">infection-targeting</option>
                                        <option value="network-protocol">network-protocol</option>
                                        <option value="port-number">port-number</option>
                                        <option value="persistence-scope">persistence-scope</option>
                                        <option value="propagation-scope">propagation-scope</option>
                                        <option value="targeted-application">targeted-application</option>
                                        <option value="targeted-file-architecture type">targeted-file-architecture type</option>
                                        <option value="targeted-file-type">targeted-file-type</option>
                                        <option value="targeted-program">targeted-program</option>
                                        <option value="targeted-sandbox">targeted-sandbox</option>
                                        <option value="targeted-vm">targeted-vm</option>
                                        <option value="targeted-website">targeted-website</option>
                                        <option value="technique">technique</option>
                                        <option value="trigger-type">trigger-type</option>
                                        <option value="user-privilege-escalation type">user-privilege-escalation type</option>
                                        <option value="vulnerability-id-cve">vulnerability-id-cve</option>
                                        <option value="vulnerability-id-osvdb">vulnerability-id-osvdb</option>
                            </select>
                                </div>
                                <div class="col-lg-4">
                                    <input type="text" class="form-control form-control-sm" id="attr_val">
                                    <input type="hidden" id="attr_dict" name="attrb_dictionary">
                                </div>
                            </div>
                            <div class="form-group row">
                                <label class="col-lg-4 col-form-label" >Behavior references:</label>
                                <div class="col-lg-8">
                                    <select class="form-control form-control-sm" multiple id="behavior_refs">
                                        <option value="None">Choose an option</option>
                                        {% for ele in behavrefsdata %}
                                        <option value="{{ ele.id }}">{{ ele.id }}--{{ ele.name }}</option>
                                        {% endfor %}
                                    </select>
                                <input type="hidden" name="behavior_refs" id="behavior_refs_final">
                                </div>
                            </div>
                            <div class="form-group row">
                                <label class="col-lg-4 col-form-label" >References:</label>
                                <div class="col-lg-8">
                                    <select class="form-control form-control-sm" multiple id="refs">
                                        <option value="None">Choose an option</option>
                                        {% for ele in extrefdata %}
                                        <option value="{{ ele.id }}">{{ ele.id }}--{{ ele.name }}</option>
                                        {% endfor %}
                                    </select>
                                <input type="hidden" name="references" id="refs_final">
                                </div>
                            </div>
                            <div class="form-group row">
                                <div class="offset-lg-4 col-lg-8">
                                    <button type="button" class="btn btn-sm btn-secondary" id="submit_refcapability" >Add</button>
                                    <button type="reset" class="btn btn-sm btn-light">Reset</button>
                                </div>
                            </div>
                    </form>
                        <div class="alert alert-success" id="success-alert6">
                            <button type="button" class="close" data-dismiss="alert">x</button>
                            <strong>Success! </strong>
                            Data has been added.
                        </div>
                        <div class="alert alert-danger" id="error-alert6">
                            <button type="button" class="close" data-dismiss="alert">x</button>
                            <strong>Error! </strong>
                            Data was not updated :(
                        </div>
                    </div>
                </div>

            </div>
        </div>
        <div class="col-lg-4">
            <!-- Add Capability -->
            <div class="card">
                <div class="card-header">6. Capability</div>
                <div class="card-body">
                    <div class="container">
                        <form method="POST" id="capabilityform" role="form" >
                            <div class="form-group row">
                                <label class="col-lg-4 col-form-label" >Name:</label>
                                <div class="col-lg-8">
                                <select class="form-control form-control-sm" name="nm">
                                    <option value="None">Choose an option</option>
                                    <option value="anti-behavioral-analysis">anti-behavioral-analysis</option>
                                    <option value="anti-code-analysis">anti-code-analysis</option>
                                    <option value="anti-detection">anti-detection</option>
                                    <option value="anti-removal">anti-removal</option>
                                    <option value="availability-violation">availability-violation</option>
                                    <option value="collection">collection</option>
                                    <option value="command-and-control">command-and-control</option>
                                    <option value="data-theft">data-theft</option>
                                    <option value="destruction">destruction</option>
                                    <option value="discovery">discovery</option>
                                    <option value="exfiltration">exfiltration</option>
                                    <option value="fraud">fraud</option>
                                    <option value="infection-propagation">infection-propagation</option>
                                    <option value="integrity-violation">integrity-violation</option>
                                    <option value="machine-access-control">machine-access-control</option>
                                    <option value="persistence">persistence</option>
                                    <option value="privilege-escalation">privilege-escalation</option>
                                    <option value="secondary-operation">secondary-operation</option>
                                    <option value="security-degradation">security-degradation</option>
                                </select>
                                  <input type="hidden" class="form-control form-control-sm" name="obj_id" value="{{ data.id }}">
                                  <input type="hidden" class="form-control form-control-sm" name="obj_type" value="{{ data.type }}">
                                  <input type="hidden" name="created_by" value="{{ session['user'] }}">
                              </div>
                             </div>
                            <div class="form-group row">
                                <label class="col-lg-4 col-form-label" >Refined capabilities:</label>
                                <div class="col-lg-8">
                                    <select class="form-control form-control-sm" multiple id="ref_capability">
                                        <option value="None">Choose an option</option>
                                        {% for ele in refcapabilitydata %}
                                        <option value="{{ ele.id }}">{{ ele.id }}--{{ ele.name }}</option>
                                        {% endfor %}
                                        <input type="hidden" id="ref_cap_final" name="ref_capabilities">
                                    </select>
                                </div>
                            </div>
                            <div class="form-group row">
                                <label class="col-lg-4 col-form-label" >Description:</label>
                                <div class="col-lg-8">
                                    <textarea class="form-control form-control-sm" rows="4" name="desc"></textarea>
                                </div>
                            </div>
                            <div class="form-group row">
                                <label class="col-lg-4 col-form-label" >Attributes:</label>
                                <div class="col-lg-4">
                                    <select class="form-control form-control-sm " id="attr_key2"  name="attr_key">
                                        <option> Choose an attribute</option>
                                        <option value="applicable-platform">applicable-platform</option>
                                        <option value="archive-type">archive-type</option>
                                        <option value="autonomy">autonomy</option>
                                        <option value="backdoor-type">backdoor-type</option>
                                        <option value="cryptocurrency-type">cryptocurrency-type</option>
                                        <option value="encryption-algorithm">encryption-algorithm</option>
                                        <option value="erasure-scope">erasure-scope</option>
                                        <option value="file-infection-type">file-infection-type</option>
                                        <option value="file-modification-type">file-modification-type</option>
                                        <option value="file-type">file-type</option>
                                        <option value="frequency">frequency</option>
                                        <option value="infection-targeting">infection-targeting</option>
                                        <option value="network-protocol">network-protocol</option>
                                        <option value="port-number">port-number</option>
                                        <option value="persistence-scope">persistence-scope</option>
                                        <option value="propagation-scope">propagation-scope</option>
                                        <option value="targeted-application">targeted-application</option>
                                        <option value="targeted-file-architecture type">targeted-file-architecture type</option>
                                        <option value="targeted-file-type">targeted-file-type</option>
                                        <option value="targeted-program">targeted-program</option>
                                        <option value="targeted-sandbox">targeted-sandbox</option>
                                        <option value="targeted-vm">targeted-vm</option>
                                        <option value="targeted-website">targeted-website</option>
                                        <option value="technique">technique</option>
                                        <option value="trigger-type">trigger-type</option>
                                        <option value="user-privilege-escalation type">user-privilege-escalation type</option>
                                        <option value="vulnerability-id-cve">vulnerability-id-cve</option>
                                        <option value="vulnerability-id-osvdb">vulnerability-id-osvdb</option>
                            </select>
                                </div>
                                <div class="col-lg-4">
                                    <input type="text" class="form-control form-control-sm" id="attr_val2">
                                    <input type="hidden" id="attr_dict2" name="attrb_dict">
                                </div>
                            </div>
                            <div class="form-group row">
                                <label class="col-lg-4 col-form-label" >Behavior references:</label>
                                <div class="col-lg-8">
                                    <select class="form-control form-control-sm" multiple id="behavior_refs2">
                                        <option value="None">Choose an option</option>
                                        {% for ele in behavrefsdata %}
                                        <option value="{{ ele.name }}">{{ ele.id }}--{{ ele.name }}</option>
                                        {% endfor %}
                                    </select>
                                <input type="hidden" name="behavior_refs" id="behavior_refs_final2">
                                </div>
                            </div>
                            <div class="form-group row">
                                <label class="col-lg-4 col-form-label" >References:</label>
                                <div class="col-lg-8">
                                    <select class="form-control form-control-sm" multiple id="refs2">
                                        <option value="None">Choose an option</option>
                                        {% for ele in extrefdata %}
                                        <option value="{{ ele.id }}">{{ ele.id }}--{{ ele.name }}</option>
                                        {% endfor %}
                                    </select>
                                <input type="hidden" name="references" id="refs_final2">
                                </div>
                            </div>
                            <div class="form-group row">
                                <div class="offset-lg-4 col-lg-8">
                                    <button type="button" class="btn btn-sm btn-secondary" id="submit_capability" >Add</button>
                                    <button type="reset" class="btn btn-sm btn-light">Reset</button>
                                </div>
                            </div>
                    </form>
                        <div class="alert alert-success" id="success-alert7">
                            <button type="button" class="close" data-dismiss="alert">x</button>
                            <strong>Success! </strong>
                            Data has been added.
                        </div>
                        <div class="alert alert-danger" id="error-alert7">
                            <button type="button" class="close" data-dismiss="alert">x</button>
                            <strong>Error! </strong>
                            Data was not updated :(
                        </div>
                    </div>
                </div>

            </div>
        </div>
        <div class="col-lg-4">
            <!-- Common code references -->
            <div class="card">
                <div class="card-header">7. Common code reference</div>
                <div class="card-body">
                    <div class="container">
                        <form method="POST"   id="artifact" role="form" >
                        <div class="form-group row">
                          <label class="col-lg-4 col-form-label" >Mime type:</label>
                          <div class="col-lg-8">
                            <input type="text" class="form-control form-control-sm" name="mime_type">
                              <input type="hidden" name="ref_type" value="none">
                              <input type="hidden" name="type" value="artifact">
                              <input type="hidden" class="form-control form-control-sm" name="obj_id" value="{{ data.id }}">
                              <input type="hidden" class="form-control form-control-sm" name="obj_type" value="{{ data.type }}">
                              <input type="hidden" name="created_by" value="{{ session['user'] }}">
                          </div>
                         </div>
                        <div class="form-group row">
                      <label class="col-lg-4 col-form-label" >Payload bin:</label>
                      <div class="col-lg-8">
                          <input type="text" class="form-control form-control-sm" id="payload" name="payload_bin">
                          <small id="urlHelpBlock" class="form-text text-muted">
                               If you want to provide information for this field, then do not add URL information
                          </small>
                      </div>
                  </div>
                            <div class="form-group row">
                      <label class="col-lg-4 col-form-label" >URL:</label>
                      <div class="col-lg-8">
                          <input type="text" class="form-control form-control-sm" id="extUrl2" readonly value="none" name="url" >
                          <small id="urlHelpBlock" class="form-text text-muted">
                                If you want to add URL information, enable the check box below to also add the hash type and value information, else, leave the box unchecked.
                          </small>
                          <div class="form-check">
                              <label class="form-check-label">
                                <input type="checkbox" class="form-check-input"  id="enableURL2">Submit URL along with Hash type and value
                              </label>
                          </div>
                      </div>
                  </div>
                    <div class="form-group row">
                        <label class="col-lg-3 col-form-label" >Hash type:</label>
                        <div class="col-lg-9">
                            <select class="form-control form-control-sm" id="hashType"  readonly name="hash_type">
                                          <option>--Choose a hash type--</option>
                                          <option value="MD5">MD5</option>
                                          <option value="MD6">MD6</option>
                                          <option value="RIPEMD-160">RIPEMD-160</option>
                                          <option value="SHA-1">SHA-1</option>
                                          <option value="SHA-224">SHA-224</option>
                                          <option value="SHA-256">SHA-256</option>
                                          <option value="SHA-384">SHA-384</option>
                                          <option value="SHA-512">SHA-512</option>
                                          <option value="SHA3-224">SHA3-224</option>
                                          <option value="SHA3-256">SHA3-256</option>
                                          <option value="SHA3-384">SHA3-384</option>
                                          <option value="SHA3-512">SHA3-512</option>
                                          <option value="ssdeep">ssdeep</option>
                                          <option value="WHIRLPOOL">WHIRLPOOL</option>
                                      </select>
                        </div>
                    </div>
                    <div class="form-group row">
                        <label class="col-lg-3 col-form-label" >Hash value:</label>
                        <div class="col-lg-9">
                            <input type="text" class="form-control form-control-sm" id="hashVal" readonly value="none"  name="hash_value">
                        </div>
                    </div>
                  <div class="form-group row">
                      <div class="offset-lg-4 col-lg-8">
                          <button type="button" class="btn btn-sm btn-secondary" id="submit_artifact" >Add</button>
                          <button type="reset" class="btn btn-sm btn-light">Reset</button>
                      </div>
                    </div>
                    </form>
                        <div class="alert alert-success" id="success-alert8">
                            <button type="button" class="close" data-dismiss="alert">x</button>
                            <strong>Success! </strong>
                            Data has been added.
                        </div>
                        <div class="alert alert-danger" id="error-alert8">
                            <button type="button" class="close" data-dismiss="alert">x</button>
                            <strong>Error! </strong>
                            Data was not updated :(
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
    <div class="row mt-2">
        <div class="col-lg-4">
        </div>
    </div>

{#        footer section#}
       <div class="row">
        <nav class="navbar navbar-expand-sm bg-dark navbar-dark fixed-bottom">
            <span class="navbar-text"> All rights reserved @ PEASEC </span>
        </nav>
</div>
</div>
</body>
</html>
