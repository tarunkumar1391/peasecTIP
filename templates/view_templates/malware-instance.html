<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Peasec Threat Intelligence Platform</title>
    <link rel="stylesheet" href="{{ url_for('static',filename = 'bootstrap/bootstrap.min.css')}}">
    <link rel="stylesheet" href="{{ url_for('static',filename = 'custom/styles.css')}}">
    <script src="{{ url_for('static',filename = 'bootstrap/jquery.min.js') }}"></script>
    <script src="{{ url_for('static',filename = 'bootstrap/popper.min.js') }}"></script>
    <script src="{{ url_for('static',filename = 'bootstrap/bootstrap.min.js') }}"></script>
    <script src="{{ url_for('static',filename = 'custom/malware-instance/view_malwareinstance.js') }}"></script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
</head>
<body>

<div class="container-fluid">
{#header section#}
        <div class="row">
            <!--Navbar-->
            <nav class="navbar navbar-expand-lg bg-light  navbar-light fixed-top " role="navigation">
                <a class="navbar-brand" href="#">
                    <img src="{{ url_for('static',filename='images/peaseclogo.png') }}" width="30" height="30" class="d-inline-block align-top" alt="">
                    PEASEC Threat Intelligence Platform</a>
                <div class="navbar-collapse">
                    <ul class=" nav nav-pills" id="myTab" role="tablist">
                    <li class="nav-item">
                      <a class="nav-link" href="{{ url_for('home') }}">Home</a>
                    </li>
                  </ul>
                </div>
                    <div class="clearfix mr-lg-5 pr-lg-5">
                        <ul class="nav navbar-nav mr-lg-auto float-lg-right " >
                          <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button"
                               aria-haspopup="true" aria-expanded="false"><span class="glyphicons glyphicons-user">
                            </span>{{ session['user'] }}</a>
                            <div class="dropdown-menu">
                              <a class="dropdown-item" href="{{ url_for('logout') }}">Logout</a>
                            </div>
                          </li>
                        </ul>
                    </div>
            </nav>
            <!--/.Navbar-->
       </div>
{#    body content section#}
    <div class="row attkpat_bodycontent ">
        <div class="col-lg-6">
            <div class="alert alert-info">
            <form method="POST" action="{{ url_for('delete_all_entry') }}">
                <input type="hidden" class="form-control " name="id" value="{{ main.id }}">
                <input type="hidden" name="obj_type" value="{{ main.type }}">
                <strong>If you wish to delete the main object and all other associated information</strong>
              <button type="submit" class="btn btn-primary">Click here</button>
            </form>
            </div>
        </div>
        <div class="col-lg-6">
            <div class="alert alert-success">
            <form method="POST" action="{{ url_for('generate_stix2') }}">
                <input type="hidden" class="form-control " name="id" value="{{ main.id }}">
                <input type="hidden" name="obj_type" value="{{ main.type }}">
                <strong>To publish as MAEC content then</strong>
              <button type="submit" class="btn btn-primary">Click here</button>
            </form>
            </div>
        </div><!-- delete main Object along with contextual information-->
        <div class="col-lg-4">
            <div class="card">
                <div class="card-header">{{ main.type }}</div>
                <div class="card-body">
                    <div class="table-responsive-sm">
                        <table class="table table-hover table-sm">
                            <thead>
                              <tr>
                                <th>#</th>
                                <th>Values</th>
                              </tr>
                            </thead>
                            <tbody>
                              <tr>
                                <td><b>Id:</b></td>
                                <td>{{main.id}}</td>
                              </tr>
                              <tr>
                                <td><b>MAEC Id:</b></td>
                                <td>{{main.maec_id}}</td>
                              </tr>
                              <tr>
                                <td><b>Input object references:</b></td>
                                <td>{{main.input_objrefs}}</td>
                              </tr>
                              <tr>
                                <td><b>Labels:</b></td>
                                <td>{{main.labels}}</td>
                              </tr>
                              <tr>
                                <td><b>Description:</b></td>
                                <td>{{main.description}}</td>
                              </tr>
                              <tr>
                                <td><b>OS execution environment:</b></td>
                                <td>{{main.os_execenv}}</td>
                              </tr>
                            <tr>
                                <td><b>Architecture execution environment:</b></td>
                                <td>{{main.arch_execenv}}</td>
                              </tr>
                            <tr>
                                <td><b>OS features:</b></td>
                                <td>{{main.os_features}}</td>
                              </tr>

                            </tbody>
                          </table>
                    </div>
                </div>

            </div>

        </div> <!-- main -->
        <div class="col-lg-6">
            <div class="card">
                <div class="card-header">External References</div>
                <div class="card-body">
                    <div class="table-responsive-sm">
                                        <table class="table table-hover table-sm">
                                              <thead>
                                                <tr>
                                                  <th >#</th>
                                                  <th >Source name</th>
                                                  <th >Description</th>
                                                  <th >url</th>
                                                  <th >Hash type</th>
                                                    <th >Hash value</th>
                                                    <th >External Id</th>
                                                  <th >Actions</th>
                                                </tr>
                                              </thead>
                                              <tbody>
                                              {% for dat in extrefdata %}
                                                <tr  row_id1="{{ dat.id }}">
                                                    <td ><div class="row_data" col_name="id">{{dat.id}}</div></td>
                                                    <td >{{dat.src_name}}</td>
                                                    <td >{{dat.description}}</td>
                                                    <td >{{dat.url}}</td>
                                                    <td >{{dat.hash_type}}</td>
                                                    <td >{{dat.hash_value}}</td>
                                                    <td >{{dat.external_id}}</td>
                                                    <td ><span class="btn_delete1" > <a href="#" class="btn btn-link " row_id1="{{ dat.id }}" > Delete</a> </span>
                                                    </td>
                                                </tr>
                                              {% endfor %}
                                              </tbody>
                                        </table>
                                  </div>
                </div>
            </div>
            <div class="card mt-lg-2">
                <div class="card-header">Capability</div>
                <div class="card-body">
                    <div class="table-responsive-sm">
                        <table class="table table-hover table-sm">
                                              <thead>
                                                <tr>
                                                  <th>#</th>
                                                  <th>Name</th>
                                                    <th>Refined capabilities</th>
                                                    <th>Description</th>
                                                    <th>Attributes</th>
                                                    <th>Behavior references</th>
                                                    <th>References</th>
                                                  <th >Action</th>
                                                </tr>
                                              </thead>
                                              <tbody>
                                              {% for dat in capabilitydata %}
                                                <tr  row_id2="{{ dat.id }}">
                                                <td ><div class="row_data" col_name="id">{{dat.id}}</div></td>
                                                <td ><div class="row_data">{{dat.name}}</div></td>
                                                <td ><div class="row_data">{{dat.refined_capabilities}}</div></td>
                                                    <td ><div class="row_data">{{dat.description}}</div></td>
                                                    <td ><div class="row_data">{{dat.attributes}}</div></td>
                                                    <td ><div class="row_data">{{dat.behavior_refs}}</div></td>
                                                    <td ><div class="row_data">{{dat.references}}</div></td>
                                                <td ><span class="btn_delete2" > <a href="#" class="btn btn-link " row_id2="{{ dat.id }}" > Delete</a> </span>
                                                </td>
                                            </tr>
                                              {% endfor %}
                                              </tbody>
                                        </table>
                                  </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row mt-lg-2">
        <div class="col-lg-4">
            <div class="card">
                <div class="card-header">Aliases</div>
                <div class="card-body">
                    <div class="table-responsive-sm">
                                        <table class="table table-hover table-sm">
                                              <thead>
                                                <tr>
                                                  <th >#</th>
                                                  <th >Value</th>
                                                  <th >Source</th>
                                                  <th >Confidence</th>
                                                  <th >Actions</th>
                                                </tr>
                                              </thead>
                                              <tbody>
                                              {% for dat in aliasesdata %}
                                                <tr  row_id3="{{ dat.id }}">
                                                    <td ><div class="row_data" col_name="id">{{dat.id}}</div></td>
                                                    <td >{{dat.value}}</td>
                                                    <td >{{dat.source}}</td>
                                                    <td >{{dat.confidence}}</td>
                                                    <td ><span class="btn_delete3" > <a href="#" class="btn btn-link " row_id3="{{ dat.id }}" > Delete</a> </span>
                                                    </td>
                                                </tr>
                                              {% endfor %}
                                              </tbody>
                                        </table>
                                  </div>
                </div>
            </div>
        </div>
        <div class="col-lg-4">
            <div class="card">
                <div class="card-header">Field Data</div>
                <div class="card-body">
                    <div class="table-responsive-sm">
                        <table class="table table-hover table-sm">
                                              <thead>
                                                <tr>
                                                  <th>#</th>
                                                  <th>Delivery vectors</th>
                                                  <th>First seen</th>
                                                  <th>Last seen</th>
                                                  <th>Action</th>
                                                </tr>
                                              </thead>
                                              <tbody>
                                              {% for dat in fielddata %}
                                                <tr  row_id4="{{ dat.id }}">
                                                <td ><div class="row_data" col_name="id">{{dat.id}}</div></td>
                                                <td ><div class="row_data" >{{dat.delivery_vectors}}</div></td>
                                                <td ><div class="row_data" >{{dat.first_seen}}</div></td>
                                                <td ><div class="row_data">{{dat.last_seen}}</div></td>
                                                <td > <span class="btn_delete4" > <a href="#" class="btn btn-link " row_id4="{{ dat.id }}" > Delete</a> </span>
                                                </td>
                                            </tr>
                                              {% endfor %}
                                              </tbody>
                                        </table>
                                  </div>
                </div>
            </div>

        </div>
        <div class="col-lg-4">
            <div class="card">
                <div class="card-header">File</div>
                <div class="card-body">
                    <div class="table-responsive-sm">
                        <table class="table table-hover table-sm">
                                              <thead>
                                                <tr>
                                                  <th>#</th>
                                                  <th>Extensions</th>
                                                  <th>Hashes</th>
                                                  <th>Size</th>
                                                  <th>Name</th>
                                                  <th>Name Encoding</th>
                                                  <th>Magic Number Hex</th>
                                                  <th>Mime type</th>
                                                  <th>Action</th>
                                                </tr>
                                              </thead>
                                              <tbody>
                                              {% for dat in filedata %}
                                                <tr  row_id5="{{ dat.id }}">
                                                <td ><div class="row_data" col_name="id">{{dat.id}}</div></td>
                                                <td ><div  >{{dat.extensions}}</div></td>
                                                <td ><div  >{{dat.hashes}}</div></td>
                                                <td ><div >{{dat.size}}</div></td>
                                                <td ><div >{{dat.name}}</div></td>
                                                <td ><div >{{dat.name_enc}}</div></td>
                                                <td ><div >{{dat.magic_number_hex}}</div></td>
                                                <td ><div >{{dat.mime_type}}</div></td>
                                                <td > <span class="btn_delete5" > <a href="#" class="btn btn-link " row_id5="{{ dat.id }}" > Delete</a> </span>
                                                </td>
                                            </tr>
                                              {% endfor %}
                                              </tbody>
                                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row mt-lg-2">
        <div class="col-lg-12">
            <div class="card">
            <div class="card-header">Dynamic Features </div>
            <div class="card-body">
                <div class=" clearfix">
                    <div class="col-lg-6 float-lg-left">
                        <div class="card">
                            <div class="card-header"> Main</div>
                            <div class="card-body">
                                <div class="container">
                                    <table class="table table-hover table-sm">
                                              <thead>
                                                <tr>
                                                  <th>#</th>
                                                  <th>Behavior references</th>
                                                  <th>Action references</th>
                                                  <th>Network traffic references</th>
                                                  <th>Process tree</th>
                                                  <th>Action</th>
                                                </tr>
                                              </thead>
                                              <tbody>
                                              {% for dat in dynamicfeaturesdata %}
                                                <tr  row_id6="{{ dat.id }}">
                                                <td ><div class="row_data" col_name="id">{{dat.id}}</div></td>
                                                <td ><div  >{{dat.behavior_refs}}</div></td>
                                                <td ><div  >{{dat.action_refs}}</div></td>
                                                <td ><div >{{dat.networktraffic_refs}}</div></td>
                                                <td ><div >{{dat.process_tree}}</div></td>
                                                <td > <span class="btn_delete6" > <a href="#" class="btn btn-link " row_id6="{{ dat.id }}" > Delete</a> </span>
                                                </td>
                                            </tr>
                                              {% endfor %}
                                              </tbody>
                                        </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-6 float-lg-right">
                        <div class="card">
                            <div class="card-header"> Process tree node</div>
                            <div class="card-body">
                                <div class="container">
                                    <table class="table table-hover table-sm">
                                              <thead>
                                                <tr>
                                                  <th>#</th>
                                                  <th>Process reference</th>
                                                  <th>Parent Action reference</th>
                                                  <th>Ordinal position</th>
                                                  <th>Initiated action references</th>
                                                  <th>Action</th>
                                                </tr>
                                              </thead>
                                              <tbody>
                                              {% for dat in processtreenodedata %}
                                                <tr  row_id7="{{ dat.id }}">
                                                <td ><div class="row_data" col_name="id">{{dat.id}}</div></td>
                                                <td ><div  >{{dat.process_ref}}</div></td>
                                                <td ><div  >{{dat.parent_actionref}}</div></td>
                                                <td ><div >{{dat.ordinal_position}}</div></td>
                                                <td ><div >{{dat.initiated_actionrefs}}</div></td>
                                                <td > <span class="btn_delete7" > <a href="#" class="btn btn-link " row_id7="{{ dat.id }}" > Delete</a> </span>
                                                </td>
                                            </tr>
                                              {% endfor %}
                                              </tbody>
                                        </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        </div>

    </div>
    <div class="row mt-lg-2">
        <div class="col-lg-12">
            <div class="card">
            <div class="card-header">Static Features</div>
            <div class="card-body ">
                <div class=" clearfix">
                    <div class="col-lg-6 float-lg-left">
                        <div class="card">
                            <div class="card-header">Main</div>
                            <div class="card-body">
                                <div class="container">
                                    <table class="table table-hover table-sm">
                                              <thead>
                                                <tr>
                                                  <th>#</th>
                                                  <th>Strings</th>
                                                  <th>Obfuscation Methods</th>
                                                  <th>Certificates</th>
                                                  <th>File headers</th>
                                                  <th>Configuration parameters</th>
                                                  <th>Development environment</th>
                                                  <th>Action</th>
                                                </tr>
                                              </thead>
                                              <tbody>
                                              {% for dat in staticfeaturesdata %}
                                                <tr  row_id8="{{ dat.id }}">
                                                <td ><div class="row_data" col_name="id">{{dat.id}}</div></td>
                                                <td ><div  >{{dat.strings}}</div></td>
                                                <td ><div  >{{dat.obfuscation_methods}}</div></td>
                                                <td ><div >{{dat.certificates}}</div></td>
                                                <td ><div >{{dat.file_headers}}</div></td>
                                                <td ><div >{{dat.configuration_params}}</div></td>
                                                <td ><div >{{dat.development_env}}</div></td>
                                                <td > <span class="btn_delete8" > <a href="#" class="btn btn-link " row_id8="{{ dat.id }}" > Delete</a> </span>
                                                </td>
                                            </tr>
                                              {% endfor %}
                                              </tbody>
                                        </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4 float-lg-right">
                        <div class="card">
                            <div class="card-header">Binary Obfuscation</div>
                            <div class="card-body">
                                <div class="container">
                                    <table class="table table-hover table-sm">
                                              <thead>
                                                <tr>
                                                  <th>#</th>
                                                  <th>Method</th>
                                                  <th>Layer order</th>
                                                  <th>Encryption Algorithm</th>
                                                  <th>Packer Name</th>
                                                  <th>Packer version</th>
                                                  <th>Action</th>
                                                </tr>
                                              </thead>
                                              <tbody>
                                              {% for dat in binaryobfsdata %}
                                                <tr  row_id9="{{ dat.id }}">
                                                <td ><div class="row_data" col_name="id">{{dat.id}}</div></td>
                                                <td ><div  >{{dat.method}}</div></td>
                                                <td ><div  >{{dat.layer_order}}</div></td>
                                                <td ><div >{{dat.encryption_algo}}</div></td>
                                                <td ><div >{{dat.packer_name}}</div></td>
                                                <td ><div >{{dat.packer_ver}}</div></td>
                                                <td > <span class="btn_delete9" > <a href="#" class="btn btn-link " row_id9="{{ dat.id }}" > Delete</a> </span>
                                                </td>
                                            </tr>
                                              {% endfor %}
                                              </tbody>
                                        </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4 float-lg-left mt-lg-2">
                        <div class="card">
                            <div class="card-header">Malware Development Environment</div>
                            <div class="card-body">
                                <div class="container">
                                    <table class="table table-hover table-sm">
                                              <thead>
                                                <tr>
                                                  <th>#</th>
                                                  <th>Tool references</th>
                                                  <th>Debugging filre references</th>
                                                  <th>Action</th>
                                                </tr>
                                              </thead>
                                              <tbody>
                                              {% for dat in malwaredevenvdata %}
                                                <tr  row_id10="{{ dat.id }}">
                                                <td ><div class="row_data" col_name="id">{{dat.id}}</div></td>
                                                <td ><div  >{{dat.tool_refs}}</div></td>
                                                <td ><div  >{{dat.debugging_filerefs}}</div></td>
                                                <td > <span class="btn_delete10" > <a href="#" class="btn btn-link " row_id10="{{ dat.id }}" > Delete</a> </span>
                                                </td>
                                            </tr>
                                              {% endfor %}
                                              </tbody>
                                        </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        </div>

    </div>
    <div class="row mt-lg-2">
        <div class="col-lg-6">
            <div class="card">
                <div class="card-header"> Analysis Metadata </div>
                <div class="card-body">
                    <div class="container">
                        <table class="table table-hover table-sm">
                                              <thead>
                                                <tr>
                                                  <th>#</th>
                                                  <th>Is Automated</th>
                                                  <th>Start time</th>
                                                  <th>End time</th>
                                                  <th>Confidence</th>
                                                  <th>Description</th>
                                                  <th>Conclusion</th>
                                                  <th>Action</th>
                                                </tr>
                                              </thead>
                                              <tbody>
                                              {% for dat in analysismetadata %}
                                                <tr  row_id11="{{ dat.id }}">
                                                <td ><div class="row_data" col_name="id">{{dat.id}}</div></td>
                                                <td ><div  >{{dat.is_automated}}</div></td>
                                                <td ><div  >{{dat.start_time}}</div></td>
                                                <td ><div >{{dat.end_time}}</div></td>
                                                <td ><div >{{dat.confidence}}</div></td>
                                                <td ><div >{{dat.description}}</div></td>
                                                <td ><div >{{dat.conclusion}}</div></td>
                                                <td > <span class="btn_delete11" > <a href="#" class="btn btn-link " row_id11="{{ dat.id }}" > Delete</a> </span>
                                                </td>
                                            </tr>
                                              {% endfor %}
                                              </tbody>
                                        </table>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-6">
            <div class="card">
                <div class="card-header"> Signature Metadata </div>
                <div class="card-body">
                    <div class="container">
                        <table class="table table-hover table-sm">
                                              <thead>
                                                <tr>
                                                  <th>#</th>
                                                  <th>Signature type</th>
                                                  <th>Name</th>
                                                  <th>Description</th>
                                                  <th>Author</th>
                                                  <th>Action</th>
                                                </tr>
                                              </thead>
                                              <tbody>
                                              {% for dat in signaturemetadata %}
                                                <tr  row_id12="{{ dat.id }}">
                                                <td ><div class="row_data" col_name="id">{{dat.id}}</div></td>
                                                <td ><div  >{{dat.signature_type}}</div></td>
                                                <td ><div  >{{dat.name}}</div></td>
                                                <td ><div >{{dat.description}}</div></td>
                                                <td ><div >{{dat.author}}</div></td>
                                                <td > <span class="btn_delete12" > <a href="#" class="btn btn-link " row_id12="{{ dat.id }}" > Delete</a> </span>
                                                </td>
                                            </tr>
                                              {% endfor %}
                                              </tbody>
                                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>




{#        footer section#}
       <div class="row">
            <nav class="navbar navbar-expand-sm bg-dark navbar-dark fixed-bottom">
                <span class="navbar-text"> All rights reserved @ PEASEC </span>
            </nav>
        </div>

</div>
</body>
</html>