$(function() {

    $("#success-alert1").hide();
    $("#error-alert1").hide();
    $("#success-alert2").hide();
    $("#error-alert2").hide();
    $("#success-alert3").hide();
    $("#error-alert3").hide();
    $("#success-alert4").hide();
    $("#error-alert4").hide();
    $("#success-alert5").hide();
    $("#error-alert5").hide();
    $("#success-alert6").hide();
    $("#error-alert6").hide();
     $("#success-alert7").hide();
    $("#error-alert7").hide();
     $("#success-alert8").hide();
    $("#error-alert8").hide();
    $("#success-alert9").hide();
    $("#error-alert9").hide();
    $("#success-alert10").hide();
    $("#error-alert10").hide();
    $("#success-alert11").hide();
    $("#error-alert11").hide();
    $("#success-alert12").hide();
    $("#error-alert12").hide();
    $("#success-alert13").hide();
    $("#error-alert13").hide();
    $("#success-alert14").hide();
    $("#error-alert14").hide();
    $("#success-alert15").hide();
    $("#error-alert15").hide();

 /* Input obj references show/hide*/
    $('#objref_type').change(function(){
            $('.input_objects').hide();
            $('#input_' + $(this).val()).show();
        });
  /* Artifact*/
    $('#submit_input_artifact').click(function() {
        $.ajax({
            url: '/insert_artifact',
            data: $('#input_artifact').serialize(),
            type: 'POST',
            success: function(response) {

             //   $("#success-alert1").fadeTo(2000, 500).slideUp(500, function(){
             //  $("#success-alert1").slideUp(500);
            //    });
                $( "#success-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                $('#input_artifact').trigger("reset");
                window.location.reload();
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });
    /* Artifact - Enable URL function*/
    $('#enableURL').change(function() {
         $('#extUrl').attr('readonly',!this.checked)
         $('#extUrl').attr('required',this.checked).val('')

         $('#hashType').attr('readonly',!this.checked)
        $('#hashType').attr('required',this.checked)

         $('#hashVal').attr('readonly',!this.checked)
        $('#hashVal').attr('required',this.checked).val('')

        $('#payload').attr('readonly',this.checked).val('')
    });

    /* Autonomous system*/
    $('#submit_input_as').click(function() {
        $.ajax({
            url: '/insert_autonomoussystem',
            data: $('#input_autonomous-system').serialize(),
            type: 'POST',
            success: function(response) {

             //   $("#success-alert1").fadeTo(2000, 500).slideUp(500, function(){
             //  $("#success-alert1").slideUp(500);
            //    });
                $( "#success-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                $('#input_autonomous-system').trigger("reset");
                window.location.reload();
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });

    /* Directory*/
    $('#submit_input_dir').click(function() {
        $.ajax({
            url: '/insert_directory',
            data: $('#input_directory').serialize(),
            type: 'POST',
            success: function(response) {

             //   $("#success-alert1").fadeTo(2000, 500).slideUp(500, function(){
             //  $("#success-alert1").slideUp(500);
            //    });
                $( "#success-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                $('#input_directory').trigger("reset");
                window.location.reload();
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });

    /* Domain-name*/
    $('#submit_input_domainname').click(function() {
        $.ajax({
            url: '/insert_domainname',
            data: $('#input_domain-name').serialize(),
            type: 'POST',
            success: function(response) {

             //   $("#success-alert1").fadeTo(2000, 500).slideUp(500, function(){
             //  $("#success-alert1").slideUp(500);
            //    });
                $( "#success-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                $('#input_domain-name').trigger("reset");
                window.location.reload();
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });

    /* Email-addr*/
    $('#submit_input_emailaddr').click(function() {
        $.ajax({
            url: '/insert_emailaddr',
            data: $('#input_email-addr').serialize(),
            type: 'POST',
            success: function(response) {

             //   $("#success-alert1").fadeTo(2000, 500).slideUp(500, function(){
             //  $("#success-alert1").slideUp(500);
            //    });
                $( "#success-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                $('#input_email-addr').trigger("reset");
                window.location.reload();
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });

    /* Email-message*/
    $('#submit_emailmsg').click(function() {
        $.ajax({
            url: '/insert_emailmsg',
            data: $('#input_email-message').serialize(),
            type: 'POST',
            success: function(response) {

             //   $("#success-alert1").fadeTo(2000, 500).slideUp(500, function(){
             //  $("#success-alert1").slideUp(500);
            //    });
                $( "#success-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                $('#input_email-message').trigger("reset");
                window.location.reload();
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });
    $('#is_multipart_check').change(function () {
        var val = $(this).val();
        if (val == 'true'){
            $('#emmsg_body').attr('disabled','true')
            $('#emmsg_bodyfinal').val('None')
        } else {
            $('#emmsg_bodyfinal').val('')
            $('#emmsg_body').removeAttr('disabled')

        }
    });
    $('#emmsg_body').keyup(function () {
        var val = $(this).val();
        $('#emmsg_bodyfinal').val(val);


    });
    $('#to_refs').change(function () {
        var value = $(this).val();
        $('#to_refs_final').val(value);
    });
    $('#cc_refs').change(function () {
        var value = $(this).val();
        $('#cc_refs_final').val(value);
    });
    $('#bcc_refs').change(function () {
        var value = $(this).val();
        $('#bcc_refs_final').val(value);
    });

    /* file */
    $('#submit_file').click(function() {
        $.ajax({
            url: '/insert_file',
            data: $('#input_file').serialize(),
            type: 'POST',
            success: function(response) {

             //   $("#success-alert1").fadeTo(2000, 500).slideUp(500, function(){
             //  $("#success-alert1").slideUp(500);
            //    });
                $( "#success-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                $('#input_file').trigger("reset");
                window.location.reload();
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });
    $('#ext_key').change(function(){

    var key = $(this).val();
    $('#ext_val').keyup(function () {
        var val1 = $(this).val();
        var result = key +":" + val1;
        $('#ext_final_val').val(result);
    });
});
    $('#hash_type').change(function(){

    var key = $(this).val();
    $('#hash_val').keyup(function () {
        var val1 = $(this).val();
        var result = key +":" + val1;
        $('#hashes_final').val(result);
    });
});
    $('#con_ref').change(function () {
        var value = $(this).val();
        $('#con_ref_final').val(value);
    });
    $('#is_enc').change(function () {
        var val = $(this).val();
        if (val == 'false'){
            $('#enc_algo').attr('disabled','true')
            $('#enc_algo_final').val('None')
        } else {
            $('#enc_algo_final').val('')
            $('#enc_algo').removeAttr('disabled')

        }
    });
    $('#enc_algo').change(function () {
        var value = $(this).val();
        $('#enc_algo_final').val(value);
    });

    /* ipv4 */
    $('#submit_ipv4').click(function() {
        $.ajax({
            url: '/insert_ipv4',
            data: $('#input_ipv4-addr').serialize(),
            type: 'POST',
            success: function(response) {

             //   $("#success-alert1").fadeTo(2000, 500).slideUp(500, function(){
             //  $("#success-alert1").slideUp(500);
            //    });
                $( "#success-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                $('#input_ipv4-addr').trigger("reset");
                window.location.reload();
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });
    $('#res_to_refs').change(function () {
        var value = $(this).val();
        $('#res_to_refs_final').val(value);
    });
    $('#belongs_to_refs').change(function () {
        var value = $(this).val();
        $('#belongs_to_refs_final').val(value);
    });

    /* ipv6 */
    $('#submit_ipv6').click(function() {
        $.ajax({
            url: '/insert_ipv6',
            data: $('#input_ipv6-addr').serialize(),
            type: 'POST',
            success: function(response) {

             //   $("#success-alert1").fadeTo(2000, 500).slideUp(500, function(){
             //  $("#success-alert1").slideUp(500);
            //    });
                $( "#success-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                $('#input_ipv6-addr').trigger("reset");
                window.location.reload();
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });
    $('#res_to_refs_v6').change(function () {
        var value = $(this).val();
        $('#res_to_refs_v6_final').val(value);
    });
    $('#belongs_to_refs_v6').change(function () {
        var value = $(this).val();
        $('#belongs_to_refs_v6_final').val(value);
    });

    /* mac */
    $('#submit_mac').click(function() {
        $.ajax({
            url: '/insert_mac',
            data: $('#input_mac-addr').serialize(),
            type: 'POST',
            success: function(response) {

             //   $("#success-alert1").fadeTo(2000, 500).slideUp(500, function(){
             //  $("#success-alert1").slideUp(500);
            //    });
                $( "#success-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                $('#input_mac-addr').trigger("reset");
                window.location.reload();
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });

    /* network-traffic */
    $('#nt_ext_key').change(function(){
        var key = $(this).val();
        $('#nt_ext_value').keyup(function () {
            var val1 = $(this).val();
            var result = key +":" + val1;
            $('#ext_dict_final').val(result);
        });
    });
    $('#src_ref').change(function () {
        var value = $(this).val();
        $('#src_ref_final').val(value);
    });
    $('#dst_ref').change(function () {
        var value = $(this).val();
        $('#dst_ref_final').val(value);
    });
    $('#src_payload_ref').change(function () {
        var value = $(this).val();
        $('#src_payload_ref_final').val(value);
    });
    $('#encapsulates_ref').change(function () {
        var value = $(this).val();
        $('#encapsulates_ref_final').val(value);
    });
    $('#encapsulatedby_ref').change(function () {
        var value = $(this).val();
        $('#encapsulatedby_ref_final').val(value);
    });
    $('#submit_nettraffic').click(function() {
        $.ajax({
            url: '/insert_networktraffic',
            data: $('#input_network-traffic').serialize(),
            type: 'POST',
            success: function(response) {

             //   $("#success-alert1").fadeTo(2000, 500).slideUp(500, function(){
             //  $("#success-alert1").slideUp(500);
            //    });
                $( "#success-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                $('#input_network-traffic').trigger("reset");
                window.location.reload();
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });

    /* process */
    $('#proc_ext_key').change(function(){
        var key = $(this).val();
        $('#proc_ext_value').keyup(function () {
            var val1 = $(this).val();
            var result = key +":" + val1;
            $('#ext_dict').val(result);
        });
    });
    $('#opened_conn_refs').change(function () {
        var value = $(this).val();
        $('#opened_conn_refs_final').val(value);
    });
    $('#child_refs').change(function () {
        var value = $(this).val();
        $('#child_refs_final').val(value);
    });
    $('#submit_process').click(function() {
        $.ajax({
            url: '/insert_process',
            data: $('#input_process').serialize(),
            type: 'POST',
            success: function(response) {

             //   $("#success-alert1").fadeTo(2000, 500).slideUp(500, function(){
             //  $("#success-alert1").slideUp(500);
            //    });
                $( "#success-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                $('#input_process').trigger("reset");
                window.location.reload();
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });

    /* software */
    $('#submit_software').click(function() {
        $.ajax({
            url: '/insert_software',
            data: $('#input_software').serialize(),
            type: 'POST',
            success: function(response) {

             //   $("#success-alert1").fadeTo(2000, 500).slideUp(500, function(){
             //  $("#success-alert1").slideUp(500);
            //    });
                $( "#success-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                $('#input_software').trigger("reset");
                window.location.reload();
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });

    /* url */
    $('#submit_url').click(function() {
        $.ajax({
            url: '/insert_url',
            data: $('#input_url').serialize(),
            type: 'POST',
            success: function(response) {

             //   $("#success-alert1").fadeTo(2000, 500).slideUp(500, function(){
             //  $("#success-alert1").slideUp(500);
            //    });
                $( "#success-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                $('#input_url').trigger("reset");
                window.location.reload();
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });

    /* user-account */
    $('#submit_useracc').click(function() {
        $.ajax({
            url: '/insert_useracc',
            data: $('#input_user-account').serialize(),
            type: 'POST',
            success: function(response) {

             //   $("#success-alert1").fadeTo(2000, 500).slideUp(500, function(){
             //  $("#success-alert1").slideUp(500);
            //    });
                $( "#success-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                $('#input_user-account').trigger("reset");
                window.location.reload();
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });
    $('#ua_ext_key').change(function(){
        var key = $(this).val();
        $('#ua_ext_value').keyup(function () {
            var val1 = $(this).val();
            var result = key +":" + val1;
            $('#ua_ext_dict').val(result);
        });
    });

     /* windows-registry key */
    $('#submit_winregkey').click(function() {
        $.ajax({
            url: '/insert_winregkey',
            data: $('#input_windows-registry-key').serialize(),
            type: 'POST',
            success: function(response) {

             //   $("#success-alert1").fadeTo(2000, 500).slideUp(500, function(){
             //  $("#success-alert1").slideUp(500);
            //    });
                $( "#success-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                $('#input_windows-registry-key').trigger("reset");
                window.location.reload();
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });

    /* x509 certificate */
    $('#submit_x509').click(function() {
        $.ajax({
            url: '/insert_x509',
            data: $('#input_x509-certificate').serialize(),
            type: 'POST',
            success: function(response) {

             //   $("#success-alert1").fadeTo(2000, 500).slideUp(500, function(){
             //  $("#success-alert1").slideUp(500);
            //    });
                $( "#success-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                $('#input_x509-certificate').trigger("reset");
                window.location.reload();
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });



    /* Update malware-instance required info*/
    $('#update_malwareinstance').click(function() {
        $.ajax({
            url: '/udpate_malwareinstance',
            data: $('#update_malwareinstanceform').serialize(),
            type: 'POST',
            success: function(response) {

             //   $("#success-alert1").fadeTo(2000, 500).slideUp(500, function(){
             //  $("#success-alert1").slideUp(500);
            //    });
                $( "#success-alert1" ).fadeIn( 300 ).delay( 2000 ).fadeOut( 400, function () {
                     window.location.reload();
                 } );
                console.log(response);
            },
            error: function(error) {
                $("#error-alert1").fadeTo(2000, 500).slideUp(500, function(){
               $("#error-alert1").slideUp(500);
                });
                console.log(error);
            }
        });

    });
    // malware-instance - multiple select
    $('#input_objrefs').change(function(){
    var values = $(this).val();
    $('#input_objrefs_final').val(values);
});
    $('#labels').change(function(){
    var values = $(this).val();
    $('#labels_final').val(values);
});

    $('#osexecenv').change(function(){
    var values = $(this).val();
    $('#osexecenv_final').val(values);
});
    $('#archexec_env').change(function(){
    var values = $(this).val();
    $('#archexec_env_final').val(values);
});
    $('#os_feat').change(function(){
    var values = $(this).val();
    $('#os_feat_final').val(values);
});

    //--------------------------


    /* Submit External References data*/
    $('#add_extref').click(function() {
        $.ajax({
            url: '/insertextref',
            data: $('#ext_refform').serialize(),
            type: 'POST',
            success: function(response) {
                 $( "#success-alert2" ).fadeIn( 300 ).delay( 2000 ).fadeOut( 400, function () {
                     window.location.reload();
                 } );

                console.log(response);
            },
            error: function(error) {
                $("#error-alert2").fadeTo(2000, 500).slideUp(500, function(){
               $("#error-alert2").slideUp(500);
                });
                console.log(error);
            }
        });

    });

    /* Submit Name data*/
    $('#submit_name').click(function() {
        $.ajax({
            url: '/insertname',
            data: $('#nameform').serialize(),
            type: 'POST',
            success: function(response) {

                 $( "#success-alert3" ).fadeIn( 300 ).delay( 2000 ).fadeOut( 400, function () {
                     window.location.reload();
                 } );
                console.log(response);
            },
            error: function(error) {
                $("#error-alert3").fadeTo(2000, 500).slideUp(500, function(){
               $("#error-alert3").slideUp(500);
                });
                console.log(error);
            }
        });

    });

    /* Aliases data*/
    $('#submit_aliases').click(function() {
        $.ajax({
            url: '/insertaliases',
            data: $('#aliasesform').serialize(),
            type: 'POST',
            success: function(response) {

                 $( "#success-alert4" ).fadeIn( 300 ).delay( 2000 ).fadeOut( 400, function () {
                     window.location.reload();
                 } );
                console.log(response);
            },
            error: function(error) {
                $("#error-alert4").fadeTo(2000, 500).slideUp(500, function(){
               $("#error-alert4").slideUp(500);
                });
                console.log(error);
            }
        });

    });
        $('#alias').change(function () {
        var value = $(this).val();
        $('#alias_final').val(value);
    });

     /* field data*/
     $('#submit_fielddata').click(function() {
        $.ajax({
            url: '/insertfielddata',
            data: $('#fielddataform').serialize(),
            type: 'POST',
            success: function(response) {
                 $( "#success-alert5" ).fadeIn( 300 ).delay( 2000 ).fadeOut( 400, function () {
                     window.location.reload();
                 } );
                console.log(response);
            },
            error: function(error) {
                $("#error-alert5").fadeTo(2000, 500).slideUp(500, function(){
               $("#error-alert5").slideUp(500);
                });
                console.log(error);
            }
        });

    });

     /* Refined capability data*/
     $('#submit_refcapability').click(function() {
        $.ajax({
            url: '/insertrefinedcapability',
            data: $('#refinedcapabilityform').serialize(),
            type: 'POST',
            success: function(response) {

                 $( "#success-alert6" ).fadeIn( 300 ).delay( 2000 ).fadeOut( 400, function () {
                     window.location.reload();
                 } );
                console.log(response);
            },
            error: function(error) {
                $("#error-alert6").fadeTo(2000, 500).slideUp(500, function(){
               $("#error-alert6").slideUp(500);
                });
                console.log(error);
            }
        });

    });
          $('#attr_key').change(function(){
        var key = $(this).val();
        $('#attr_val').keyup(function () {
            var val1 = $(this).val();
            var result = key +":" + val1;
            $('#attr_dict').val(result);
        });
    });
          $('#behavior_refs').change(function () {
            var value = $(this).val();
            $('#behavior_refs_final').val(value);
          });
          $('#refs').change(function () {
            var value = $(this).val();
            $('#refs_final').val(value);
          });

     /* capability data*/
     $('#submit_capability').click(function() {
        $.ajax({
            url: '/insertcapability',
            data: $('#capabilityform').serialize(),
            type: 'POST',
            success: function(response) {

                 $( "#success-alert7" ).fadeIn( 300 ).delay( 2000 ).fadeOut( 400, function () {
                     window.location.reload();
                 } );
                console.log(response);
            },
            error: function(error) {
                $("#error-alert7").fadeTo(2000, 500).slideUp(500, function(){
               $("#error-alert7").slideUp(500);
                });
                console.log(error);
            }
        });

    });
        $('#attr_key2').change(function(){
        var key = $(this).val();
        $('#attr_val2').keyup(function () {
            var val1 = $(this).val();
            var result = key +":" + val1;
            $('#attr_dict2').val(result);
        });
    });
        $('#behavior_refs2').change(function () {
            var value = $(this).val();
            $('#behavior_refs_final2').val(value);
          });
          $('#refs2').change(function () {
            var value = $(this).val();
            $('#refs_final2').val(value);
          });

     /* Common code refs data*/
    /* Input references */

    $('#is_enc').change(function () {
        var val = $(this).val();
        if (val == 'false'){
            $('#enc_algo').attr('disabled','true')
            $('#enc_algo_final').val('None')
        } else {
            $('#enc_algo_final').val('')
            $('#enc_algo').removeAttr('disabled')

        }
    });
    $('#enc_algo').change(function () {
        var value = $(this).val();
        $('#enc_algo_final').val(value);
    });



    /* Dynamic features */
    $('#submit_dynamicfeatures').click(function() {
        $.ajax({
            url: '/insert_dynamicfeatures',
            data: $('#dynamicfeaturesform').serialize(),
            type: 'POST',
            success: function(response) {

              $( "#success-alert9" ).fadeIn( 300 ).delay( 2000 ).fadeOut( 400, function () {
                     window.location.reload();
                 } );
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert9" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });
        $('#behavior_refs_df').change(function () {
        var value = $(this).val();
        $('#behavior_refs_df_final').val(value);
    });
        $('#action_refs').change(function () {
        var value = $(this).val();
        $('#action_refs_final').val(value);
    });
        $('#networktraffic_refs').change(function () {
        var value = $(this).val();
        $('#networktraffic_refs_final').val(value);
    });
        $('#process_tree').change(function () {
        var value = $(this).val();
        $('#process_tree_final').val(value);
    });

        $('#submit_processtreenode').click(function() {
        $.ajax({
            url: '/insert_processtreenode',
            data: $('#processtreenodeform').serialize(),
            type: 'POST',
            success: function(response) {

              $( "#success-alert10" ).fadeIn( 300 ).delay( 2000 ).fadeOut( 400, function () {
                     window.location.reload();
                 } );
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert10" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });
        $('#initaction_refs').change(function () {
        var value = $(this).val();
        $('#initaction_refs_final').val(value);
    });

    /* Static features */
    $('#submit_staticfeatures').click(function() {
        $.ajax({
            url: '/insert_staticfeatures',
            data: $('#staticfeaturesform').serialize(),
            type: 'POST',
            success: function(response) {

              $( "#success-alert11" ).fadeIn( 300 ).delay( 2000 ).fadeOut( 400, function () {
                     window.location.reload();
                 } );
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert11" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });
        $('#obfuscation_methods').change(function () {
        var value = $(this).val();
        $('#obfuscation_methods_final').val(value);
    });
        $('#certificates').change(function () {
        var value = $(this).val();
        $('#certificates_final').val(value);
    });
        $('#file_headers').change(function () {
        var value = $(this).val();
        $('#file_headers_final').val(value);
    });
        $('#configparams_key').change(function(){
            var key = $(this).val();
            $('#configparams_val').keyup(function () {
                var val1 = $(this).val();
                var result = key +":" + val1;
                $('#configparams_dict').val(result);
            });
});
    $('#submit_binaryobfuscation').click(function() {
        $.ajax({
            url: '/insert_binaryobfuscation',
            data: $('#binaryobfuscationform').serialize(),
            type: 'POST',
            success: function(response) {

              $( "#success-alert12" ).fadeIn( 300 ).delay( 2000 ).fadeOut( 400, function () {
                     window.location.reload();
                 } );
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert12" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });
    $('#submit_maldevenv').click(function() {
        $.ajax({
            url: '/insert_malwaredevenv',
            data: $('#maldevenvform').serialize(),
            type: 'POST',
            success: function(response) {

              $( "#success-alert13" ).fadeIn( 300 ).delay( 2000 ).fadeOut( 400, function () {
                     window.location.reload();
                 } );
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert13" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });
        $('#tool_refs').change(function () {
        var value = $(this).val();
        $('#tool_refs_final').val(value);
    });
        $('#debugginfile_refs').change(function () {
        var value = $(this).val();
        $('#debugginfile_refs_final').val(value);
    });
    /* Analysis metadata */
    $('#submit_analysismetadata').click(function() {
        $.ajax({
            url: '/insert_analysismetadata',
            data: $('#analysismetadataform').serialize(),
            type: 'POST',
            success: function(response) {

              $( "#success-alert14" ).fadeIn( 300 ).delay( 2000 ).fadeOut( 400, function () {
                     window.location.reload();
                 } );
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert14" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });
        $('#tool_refs2').change(function () {
        var value = $(this).val();
        $('#tool_refs2_final').val(value);
    });
        $('#ext_refs').change(function () {
        var value = $(this).val();
        $('#ext_refs_final').val(value);
    });
        $('#automated_check').change(function () {
        var value = $(this).val();
        if (value == "true"){
            $('#analyst').attr('disabled','true');
            $('#analyst_final').val('None');

            $('#analysis_type').attr('disabled','true');
            $('#analysis_typefinal').val('None');

            $('#analysisenv_key').attr('disabled','true');
            $('#analysisenv_val').attr('disabled','true');
            $('#analysisenv_dict').val('None');


        } else {
            $('#analyst').removeAttr('disabled','true');
            $('#analyst_final').val('');

            $('#analysis_type').removeAttr('disabled','true');
            $('#analysis_typefinal').val('');

            $('#analysisenv_key').removeAttr('disabled','true');
            $('#analysisenv_val').removeAttr('disabled','true');
            $('#analysisenv_dict').val('');
        }
    });
        $('#analysis_type').change(function () {
        var value = $(this).val();
        if (value == "static"){
             $('#analysisenv_key').attr('disabled','true');
            $('#analysisenv_val').attr('disabled','true');
            $('#analysisenv_dict').val('None');
        } else {
            $('#analysisenv_key').removeAttr('disabled','true');
            $('#analysisenv_val').removeAttr('disabled','true');
            $('#analysisenv_dict').val('');
        }

    });

    $('#analysisenv_key').change(function () {
        var key = $(this).val();
        $('#analysisenv_val').change(function () {
            var val = $(this).val();
            var final = key + ':' + val;
            $('#analysisenv_dict').val(final);
        });
    });

    /* Signature metadata */
     $('#submit_signaturemetadata').click(function() {
        $.ajax({
            url: '/insert_signaturemetadata',
            data: $('#signaturemetadataform').serialize(),
            type: 'POST',
            success: function(response) {

              $( "#success-alert15" ).fadeIn( 300 ).delay( 2000 ).fadeOut( 400, function () {
                     window.location.reload();
                 } );
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert15" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });
});





