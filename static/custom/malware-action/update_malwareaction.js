$(function() {

    $("#success-alert1").hide();
    $("#error-alert1").hide();
    $("#success-alert2").hide();
    $("#error-alert2").hide();
    $("#success-alert3").hide();
    $("#error-alert3").hide();
     $("#success-alert4").hide();
    $("#error-alert4").hide();


    /* Update malware-action required info*/
    $('#update_malwareaction').click(function() {
        $.ajax({
            url: '/update_malwareaction',
            data: $('#update_malwareactionform').serialize(),
            type: 'POST',
            success: function(response) {

             //   $("#success-alert1").fadeTo(2000, 500).slideUp(500, function(){
             //  $("#success-alert1").slideUp(500);
            //    });
                $( "#success-alert1" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                window.location.reload();
                console.log(response);
            },
            error: function(error) {
                $("#error-alert1").fadeTo(2000, 500).slideUp(500, function(){
               $("#error-alert1").slideUp(500);
                });
                console.log(error);
            }
        });

    });
    $('#is_successful').change(function () {
        var value = $(this).val();
        $('#is_successful_final').val(value);
    });
    $('#nm').change(function () {
        var value = $(this).val();
        $('#nm_final').val(value);
    });
    /* input refs drop down */
    $('#input_object_refs').change(function () {
        var val1 =$ (this).val();
        var result =  val1 + ',';
        $('#input_refs').val(result);
    });
    /* output refs drop down */
    $('#output_object_refs').change(function () {
        var val1 =$ (this).val();
        var result =  val1;
        $('#output_refs').val(result);
    });
    /* directory drop down */
    $('#dir_contains_refs').change(function () {
        var val1 =$ (this).val();
        var result =  val1 + ',';
        $('#dir_contains_refs_final').val(result);
    });
    /* domain name refs drop down */
    $('#dn_resolves_to_refs').change(function () {
        var val1 =$ (this).val();
        var result =  val1 + ',';
        $('#dn_resolves_to_refs_final').val(result);
    });


     /* Input obj references show/hide*/
    $('#input_objref_type').change(function(){
            $('.input_objects').hide();
            $('#input_' + $(this).val()).show();
        });

    /* Output obj references show/hide*/
    $('#output_objref_type').change(function(){
            $('.output_objects').hide();
            $('#output_' + $(this).val()).show();
        });

    /* Input references */
     /* Artifact*/
    $('#submit_input_artifact').click(function() {
        $.ajax({
            url: '/insert_artifact',
            data: $('#input_artifact').serialize(),
            type: 'POST',
            success: function(response) {

             //   $("#success-alert1").fadeTo(2000, 500).slideUp(500, function(){
             //  $("#success-alert1").slideUp(500);
            //    });
                $( "#success-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                $('#input_artifact').trigger("reset");
                window.location.reload();
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });
    /* Artifact - Enable URL function*/
    $('#enableURL').change(function() {
         $('#extUrl').attr('readonly',!this.checked)
         $('#extUrl').attr('required',this.checked).val('')

         $('#hashType').attr('readonly',!this.checked)
        $('#hashType').attr('required',this.checked)

         $('#hashVal').attr('readonly',!this.checked)
        $('#hashVal').attr('required',this.checked).val('')

        $('#payload').attr('readonly',this.checked).val('')
    });

    /* Autonomous system*/
    $('#submit_input_as').click(function() {
        $.ajax({
            url: '/insert_autonomoussystem',
            data: $('#input_autonomous-system').serialize(),
            type: 'POST',
            success: function(response) {

             //   $("#success-alert1").fadeTo(2000, 500).slideUp(500, function(){
             //  $("#success-alert1").slideUp(500);
            //    });
                $( "#success-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                $('#input_autonomous-system').trigger("reset");
                window.location.reload();
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });

    /* Directory*/
    $('#submit_input_dir').click(function() {
        $.ajax({
            url: '/insert_directory',
            data: $('#input_directory').serialize(),
            type: 'POST',
            success: function(response) {

             //   $("#success-alert1").fadeTo(2000, 500).slideUp(500, function(){
             //  $("#success-alert1").slideUp(500);
            //    });
                $( "#success-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                $('#input_directory').trigger("reset");
                window.location.reload();
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });

    /* Domain-name*/
    $('#submit_input_domainname').click(function() {
        $.ajax({
            url: '/insert_domainname',
            data: $('#input_domain-name').serialize(),
            type: 'POST',
            success: function(response) {

             //   $("#success-alert1").fadeTo(2000, 500).slideUp(500, function(){
             //  $("#success-alert1").slideUp(500);
            //    });
                $( "#success-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                $('#input_domain-name').trigger("reset");
                window.location.reload();
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });

    /* Email-addr*/
    $('#submit_input_emailaddr').click(function() {
        $.ajax({
            url: '/insert_emailaddr',
            data: $('#input_email-addr').serialize(),
            type: 'POST',
            success: function(response) {

             //   $("#success-alert1").fadeTo(2000, 500).slideUp(500, function(){
             //  $("#success-alert1").slideUp(500);
            //    });
                $( "#success-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                $('#input_email-addr').trigger("reset");
                window.location.reload();
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });

    /* Email-message*/
    $('#submit_emailmsg').click(function() {
        $.ajax({
            url: '/insert_emailmsg',
            data: $('#input_email-message').serialize(),
            type: 'POST',
            success: function(response) {

             //   $("#success-alert1").fadeTo(2000, 500).slideUp(500, function(){
             //  $("#success-alert1").slideUp(500);
            //    });
                $( "#success-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                $('#input_email-message').trigger("reset");
                window.location.reload();
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });
    $('#is_multipart_check').change(function () {
        var val = $(this).val();
        if (val == 'true'){
            $('#emmsg_body').attr('disabled','true')
            $('#emmsg_bodyfinal').val('None')
        } else {
            $('#emmsg_bodyfinal').val('')
            $('#emmsg_body').removeAttr('disabled')

        }
    });
    $('#emmsg_body').keyup(function () {
        var val = $(this).val();
        $('#emmsg_bodyfinal').val(val);


    });
    $('#to_refs').change(function () {
        var value = $(this).val();
        $('#to_refs_final').val(value);
    });
    $('#cc_refs').change(function () {
        var value = $(this).val();
        $('#cc_refs_final').val(value);
    });
    $('#bcc_refs').change(function () {
        var value = $(this).val();
        $('#bcc_refs_final').val(value);
    });

    /* file */
    $('#submit_file').click(function() {
        $.ajax({
            url: '/insert_file',
            data: $('#input_file').serialize(),
            type: 'POST',
            success: function(response) {

             //   $("#success-alert1").fadeTo(2000, 500).slideUp(500, function(){
             //  $("#success-alert1").slideUp(500);
            //    });
                $( "#success-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                $('#input_file').trigger("reset");
                window.location.reload();
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });
    $('#ext_key').change(function(){

    var key = $(this).val();
    $('#ext_val').keyup(function () {
        var val1 = $(this).val();
        var result = key +":" + val1;
        $('#ext_final_val').val(result);
    });
});
    $('#hash_type').change(function(){

    var key = $(this).val();
    $('#hash_val').keyup(function () {
        var val1 = $(this).val();
        var result = key +":" + val1;
        $('#hashes_final').val(result);
    });
});
    $('#con_ref').change(function () {
        var value = $(this).val();
        $('#con_ref_final').val(value);
    });
    $('#is_enc').change(function () {
        var val = $(this).val();
        if (val == 'false'){
            $('#enc_algo').attr('disabled','true')
            $('#enc_algo_final').val('None')
        } else {
            $('#enc_algo_final').val('')
            $('#enc_algo').removeAttr('disabled')

        }
    });
    $('#enc_algo').change(function () {
        var value = $(this).val();
        $('#enc_algo_final').val(value);
    });

    /* ipv4 */
    $('#submit_ipv4').click(function() {
        $.ajax({
            url: '/insert_ipv4',
            data: $('#input_ipv4-addr').serialize(),
            type: 'POST',
            success: function(response) {

             //   $("#success-alert1").fadeTo(2000, 500).slideUp(500, function(){
             //  $("#success-alert1").slideUp(500);
            //    });
                $( "#success-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                $('#input_ipv4-addr').trigger("reset");
                window.location.reload();
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });
    $('#res_to_refs').change(function () {
        var value = $(this).val();
        $('#res_to_refs_final').val(value);
    });
    $('#belongs_to_refs').change(function () {
        var value = $(this).val();
        $('#belongs_to_refs_final').val(value);
    });

    /* ipv6 */
    $('#submit_ipv6').click(function() {
        $.ajax({
            url: '/insert_ipv6',
            data: $('#input_ipv6-addr').serialize(),
            type: 'POST',
            success: function(response) {

             //   $("#success-alert1").fadeTo(2000, 500).slideUp(500, function(){
             //  $("#success-alert1").slideUp(500);
            //    });
                $( "#success-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                $('#input_ipv6-addr').trigger("reset");
                window.location.reload();
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });
    $('#res_to_refs_v6').change(function () {
        var value = $(this).val();
        $('#res_to_refs_v6_final').val(value);
    });
    $('#belongs_to_refs_v6').change(function () {
        var value = $(this).val();
        $('#belongs_to_refs_v6_final').val(value);
    });

    /* mac */
    $('#submit_mac').click(function() {
        $.ajax({
            url: '/insert_mac',
            data: $('#input_mac-addr').serialize(),
            type: 'POST',
            success: function(response) {

             //   $("#success-alert1").fadeTo(2000, 500).slideUp(500, function(){
             //  $("#success-alert1").slideUp(500);
            //    });
                $( "#success-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                $('#input_mac-addr').trigger("reset");
                window.location.reload();
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });

    /* network-traffic */
    $('#nt_ext_key').change(function(){
        var key = $(this).val();
        $('#nt_ext_value').keyup(function () {
            var val1 = $(this).val();
            var result = key +":" + val1;
            $('#ext_dict_final').val(result);
        });
    });
    $('#src_ref').change(function () {
        var value = $(this).val();
        $('#src_ref_final').val(value);
    });
    $('#dst_ref').change(function () {
        var value = $(this).val();
        $('#dst_ref_final').val(value);
    });
    $('#src_payload_ref').change(function () {
        var value = $(this).val();
        $('#src_payload_ref_final').val(value);
    });
    $('#encapsulates_ref').change(function () {
        var value = $(this).val();
        $('#encapsulates_ref_final').val(value);
    });
    $('#encapsulatedby_ref').change(function () {
        var value = $(this).val();
        $('#encapsulatedby_ref_final').val(value);
    });
    $('#submit_nettraffic').click(function() {
        $.ajax({
            url: '/insert_networktraffic',
            data: $('#input_network-traffic').serialize(),
            type: 'POST',
            success: function(response) {

             //   $("#success-alert1").fadeTo(2000, 500).slideUp(500, function(){
             //  $("#success-alert1").slideUp(500);
            //    });
                $( "#success-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                $('#input_network-traffic').trigger("reset");
                window.location.reload();
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });

    /* process */
    $('#proc_ext_key').change(function(){
        var key = $(this).val();
        $('#proc_ext_value').keyup(function () {
            var val1 = $(this).val();
            var result = key +":" + val1;
            $('#ext_dict').val(result);
        });
    });
    $('#opened_conn_refs').change(function () {
        var value = $(this).val();
        $('#opened_conn_refs_final').val(value);
    });
    $('#child_refs').change(function () {
        var value = $(this).val();
        $('#child_refs_final').val(value);
    });
    $('#submit_process').click(function() {
        $.ajax({
            url: '/insert_process',
            data: $('#input_process').serialize(),
            type: 'POST',
            success: function(response) {

             //   $("#success-alert1").fadeTo(2000, 500).slideUp(500, function(){
             //  $("#success-alert1").slideUp(500);
            //    });
                $( "#success-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                $('#input_process').trigger("reset");
                window.location.reload();
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });

    /* software */
    $('#submit_software').click(function() {
        $.ajax({
            url: '/insert_software',
            data: $('#input_software').serialize(),
            type: 'POST',
            success: function(response) {

             //   $("#success-alert1").fadeTo(2000, 500).slideUp(500, function(){
             //  $("#success-alert1").slideUp(500);
            //    });
                $( "#success-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                $('#input_software').trigger("reset");
                window.location.reload();
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });

    /* url */
    $('#submit_url').click(function() {
        $.ajax({
            url: '/insert_url',
            data: $('#input_url').serialize(),
            type: 'POST',
            success: function(response) {

             //   $("#success-alert1").fadeTo(2000, 500).slideUp(500, function(){
             //  $("#success-alert1").slideUp(500);
            //    });
                $( "#success-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                $('#input_url').trigger("reset");
                window.location.reload();
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });

    /* user-account */
    $('#submit_useracc').click(function() {
        $.ajax({
            url: '/insert_useracc',
            data: $('#input_user-account').serialize(),
            type: 'POST',
            success: function(response) {

             //   $("#success-alert1").fadeTo(2000, 500).slideUp(500, function(){
             //  $("#success-alert1").slideUp(500);
            //    });
                $( "#success-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                $('#input_user-account').trigger("reset");
                window.location.reload();
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });
    $('#ua_ext_key').change(function(){
        var key = $(this).val();
        $('#ua_ext_value').keyup(function () {
            var val1 = $(this).val();
            var result = key +":" + val1;
            $('#ua_ext_dict').val(result);
        });
    });

     /* windows-registry key */
    $('#submit_winregkey').click(function() {
        $.ajax({
            url: '/insert_winregkey',
            data: $('#input_windows-registry-key').serialize(),
            type: 'POST',
            success: function(response) {

             //   $("#success-alert1").fadeTo(2000, 500).slideUp(500, function(){
             //  $("#success-alert1").slideUp(500);
            //    });
                $( "#success-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                $('#input_windows-registry-key').trigger("reset");
                window.location.reload();
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });

    /* x509 certificate */
    $('#submit_x509').click(function() {
        $.ajax({
            url: '/insert_x509',
            data: $('#input_x509-certificate').serialize(),
            type: 'POST',
            success: function(response) {

             //   $("#success-alert1").fadeTo(2000, 500).slideUp(500, function(){
             //  $("#success-alert1").slideUp(500);
            //    });
                $( "#success-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                $('#input_x509-certificate').trigger("reset");
                window.location.reload();
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert2" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });

    /* Output references */

      /* Artifact*/
    $('#submit_output_artifact').click(function() {
        $.ajax({
            url: '/insert_artifact',
            data: $('#output_artifact').serialize(),
            type: 'POST',
            success: function(response) {

             //   $("#success-alert1").fadeTo(2000, 500).slideUp(500, function(){
             //  $("#success-alert1").slideUp(500);
            //    });
                $( "#success-alert3" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                $('#output_artifact').trigger("reset");
                window.location.reload();
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert3" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });
    /* Artifact - Enable URL function*/
    $('#enableURL2').change(function() {
         $('#extUrl2').attr('readonly',!this.checked)
         $('#extUrl2').attr('required',this.checked).val('')

         $('#hashType2').attr('readonly',!this.checked)
        $('#hashType2').attr('required',this.checked)

         $('#hashVal2').attr('readonly',!this.checked)
        $('#hashVal2').attr('required',this.checked).val('')

        $('#payload2').attr('readonly',this.checked).val('')
    });

    /* Autonomous system*/
    $('#submit_output_as').click(function() {
        $.ajax({
            url: '/insert_autonomoussystem',
            data: $('#output_autonomous-system').serialize(),
            type: 'POST',
            success: function(response) {

             //   $("#success-alert1").fadeTo(2000, 500).slideUp(500, function(){
             //  $("#success-alert1").slideUp(500);
            //    });
                $( "#success-alert3" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                $('#output_autonomous-system').trigger("reset");
                window.location.reload();
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert3" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });

    /* Directory*/
    $('#submit_output_dir').click(function() {
        $.ajax({
            url: '/insert_directory',
            data: $('#output_directory').serialize(),
            type: 'POST',
            success: function(response) {

             //   $("#success-alert1").fadeTo(2000, 500).slideUp(500, function(){
             //  $("#success-alert1").slideUp(500);
            //    });
                $( "#success-alert3" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                $('#output_directory').trigger("reset");
                window.location.reload();
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert3" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });

    /* Domain-name*/
    $('#submit_output_domainname').click(function() {
        $.ajax({
            url: '/insert_domainname',
            data: $('#output_domain-name').serialize(),
            type: 'POST',
            success: function(response) {

             //   $("#success-alert1").fadeTo(2000, 500).slideUp(500, function(){
             //  $("#success-alert1").slideUp(500);
            //    });
                $( "#success-alert3" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                $('#output_domain-name').trigger("reset");
                window.location.reload();
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert3" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });

    /* Email-addr*/
    $('#submit_output_emailaddr').click(function() {
        $.ajax({
            url: '/insert_emailaddr',
            data: $('#output_email-addr').serialize(),
            type: 'POST',
            success: function(response) {

             //   $("#success-alert1").fadeTo(2000, 500).slideUp(500, function(){
             //  $("#success-alert1").slideUp(500);
            //    });
                $( "#success-alert3" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                $('#output_email-addr').trigger("reset");
                window.location.reload();
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert3" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });

    /* Email-message*/
    $('#submit_output_emailmsg').click(function() {
        $.ajax({
            url: '/insert_emailmsg',
            data: $('#output_email-message').serialize(),
            type: 'POST',
            success: function(response) {

             //   $("#success-alert1").fadeTo(2000, 500).slideUp(500, function(){
             //  $("#success-alert1").slideUp(500);
            //    });
                $( "#success-alert3" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                $('#output_email-message').trigger("reset");
                window.location.reload();
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert3" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });
    $('#is_multipart_check2').change(function () {
        var val = $(this).val();
        if (val == 'true'){
            $('#emmsg_body2').attr('disabled','true')
            $('#emmsg_bodyfinal2').val('None')
        } else {
            $('#emmsg_bodyfinal2').val('')
            $('#emmsg_body2').removeAttr('disabled')

        }
    });
    $('#emmsg_body2').keyup(function () {
        var val = $(this).val();
        $('#emmsg_bodyfinal2').val(val);


    });
    $('#to_refs2').change(function () {
        var value = $(this).val();
        $('#to_refs_final2').val(value);
    });
    $('#cc_refs2').change(function () {
        var value = $(this).val();
        $('#cc_refs_final2').val(value);
    });
    $('#bcc_refs2').change(function () {
        var value = $(this).val();
        $('#bcc_refs_final2').val(value);
    });

    /* file */
    $('#submit_output_file').click(function() {
        $.ajax({
            url: '/insert_file',
            data: $('#output_file').serialize(),
            type: 'POST',
            success: function(response) {

             //   $("#success-alert1").fadeTo(2000, 500).slideUp(500, function(){
             //  $("#success-alert1").slideUp(500);
            //    });
                $( "#success-alert3" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                $('#output_file').trigger("reset");
                window.location.reload();
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert3" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });
    $('#ext_key2').change(function(){
        var key = $(this).val();
    $('#ext_val2').keyup(function () {
        var val1 = $(this).val();
        var result = key +":" + val1;
        $('#ext_final_val2').val(result);
    });
});
    $('#hash_type2').change(function(){

    var key = $(this).val();
    $('#hash_val2').keyup(function () {
        var val1 = $(this).val();
        var result = key +":" + val1;
        $('#hashes_final2').val(result);
    });
});
    $('#con_ref2').change(function () {
        var value = $(this).val();
        $('#con_ref_final2').val(value);
    });
    $('#is_enc2').change(function () {
        var val = $(this).val();
        if (val == 'false'){
            $('#enc_algo2').attr('disabled','true')
            $('#enc_algo_final2').val('None')
        } else {
            $('#enc_algo_final2').val('')
            $('#enc_algo2').removeAttr('disabled')

        }
    });
    $('#enc_algo2').change(function () {
        var value = $(this).val();
        $('#enc_algo_final2').val(value);
    });

    /* ipv4 */
    $('#submit_output_ipv4').click(function() {
        $.ajax({
            url: '/insert_ipv4',
            data: $('#output_ipv4-addr').serialize(),
            type: 'POST',
            success: function(response) {

             //   $("#success-alert1").fadeTo(2000, 500).slideUp(500, function(){
             //  $("#success-alert1").slideUp(500);
            //    });
                $( "#success-alert3" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                $('#output_ipv4-addr').trigger("reset");
                window.location.reload();
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert3" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });
    $('#res_to_refs2').change(function () {
        var value = $(this).val();
        $('#res_to_refs_final2').val(value);
    });
    $('#belongs_to_refs2').change(function () {
        var value = $(this).val();
        $('#belongs_to_refs_final2').val(value);
    });

    /* ipv6 */
    $('#submit_output_ipv6').click(function() {
        $.ajax({
            url: '/insert_ipv6',
            data: $('#output_ipv6-addr').serialize(),
            type: 'POST',
            success: function(response) {

             //   $("#success-alert1").fadeTo(2000, 500).slideUp(500, function(){
             //  $("#success-alert1").slideUp(500);
            //    });
                $( "#success-alert3" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                $('#output_ipv6-addr').trigger("reset");
                window.location.reload();
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert3" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });
    $('#res_to_refs_v62').change(function () {
        var value = $(this).val();
        $('#res_to_refs_v6_final2').val(value);
    });
    $('#belongs_to_refs_v62').change(function () {
        var value = $(this).val();
        $('#belongs_to_refs_v6_final2').val(value);
    });

    /* mac */
    $('#submit_output_mac').click(function() {
        $.ajax({
            url: '/insert_mac',
            data: $('#output_mac-addr').serialize(),
            type: 'POST',
            success: function(response) {

             //   $("#success-alert1").fadeTo(2000, 500).slideUp(500, function(){
             //  $("#success-alert1").slideUp(500);
            //    });
                $( "#success-alert3" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                $('#output_mac-addr').trigger("reset");
                window.location.reload();
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert3" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });

    /* network-traffic */
    $('#nt_ext_key2').change(function(){
        var key = $(this).val();
        $('#nt_ext_value2').keyup(function () {
            var val1 = $(this).val();
            var result = key +":" + val1;
            $('#ext_dict_final2').val(result);
        });
    });
    $('#src_ref2').change(function () {
        var value = $(this).val();
        $('#src_ref_final2').val(value);
    });
    $('#dst_ref2').change(function () {
        var value = $(this).val();
        $('#dst_ref_final2').val(value);
    });
    $('#src_payload_ref2').change(function () {
        var value = $(this).val();
        $('#src_payload_ref_final2').val(value);
    });
    $('#dst_payload_ref2').change(function () {
        var value = $(this).val();
        $('#dst_payload_ref_final2').val(value);
    });
    $('#encapsulates_ref2').change(function () {
        var value = $(this).val();
        $('#encapsulates_ref_final2').val(value);
    });
    $('#encapsulatedby_ref2').change(function () {
        var value = $(this).val();
        $('#encapsulatedby_ref_final2').val(value);
    });
    $('#submit_output_nettraffic').click(function() {
        $.ajax({
            url: '/insert_networktraffic',
            data: $('#output_network-traffic').serialize(),
            type: 'POST',
            success: function(response) {

             //   $("#success-alert1").fadeTo(2000, 500).slideUp(500, function(){
             //  $("#success-alert1").slideUp(500);
            //    });
                $( "#success-alert3" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                $('#output_network-traffic').trigger("reset");
                window.location.reload();
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert3" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });

    /* process */
    $('#proc_ext_key2').change(function(){
        var key = $(this).val();
        $('#proc_ext_value2').keyup(function () {
            var val1 = $(this).val();
            var result = key +":" + val1;
            $('#ext_dict2').val(result);
        });
    });
    $('#opened_conn_refs2').change(function () {
        var value = $(this).val();
        $('#opened_conn_refs_final2').val(value);
    });
    $('#child_refs2').change(function () {
        var value = $(this).val();
        $('#child_refs_final2').val(value);
    });
    $('#submit_output_process').click(function() {
        $.ajax({
            url: '/insert_process',
            data: $('#output_process').serialize(),
            type: 'POST',
            success: function(response) {

             //   $("#success-alert1").fadeTo(2000, 500).slideUp(500, function(){
             //  $("#success-alert1").slideUp(500);
            //    });
                $( "#success-alert3" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                $('#output_process').trigger("reset");
                window.location.reload();
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert3" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });

    /* software */
    $('#submit_output_software').click(function() {
        $.ajax({
            url: '/insert_software',
            data: $('#output_software').serialize(),
            type: 'POST',
            success: function(response) {

             //   $("#success-alert1").fadeTo(2000, 500).slideUp(500, function(){
             //  $("#success-alert1").slideUp(500);
            //    });
                $( "#success-alert3" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                $('#output_software').trigger("reset");
                window.location.reload();
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert3" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });

    /* url */
    $('#submit_output_url').click(function() {
        $.ajax({
            url: '/insert_url',
            data: $('#output_url').serialize(),
            type: 'POST',
            success: function(response) {

             //   $("#success-alert1").fadeTo(2000, 500).slideUp(500, function(){
             //  $("#success-alert1").slideUp(500);
            //    });
                $( "#success-alert3" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                $('#output_url').trigger("reset");
                window.location.reload();
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert3" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });

    /* user-account */
    $('#submit_output_useracc').click(function() {
        $.ajax({
            url: '/insert_useracc',
            data: $('#output_user-account').serialize(),
            type: 'POST',
            success: function(response) {

             //   $("#success-alert1").fadeTo(2000, 500).slideUp(500, function(){
             //  $("#success-alert1").slideUp(500);
            //    });
                $( "#success-alert3" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                $('#output_user-account').trigger("reset");
                window.location.reload();
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert3" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });
    $('#ua_ext_key2').change(function(){
        var key = $(this).val();
        $('#ua_ext_value2').keyup(function () {
            var val1 = $(this).val();
            var result = key +":" + val1;
            $('#ua_ext_dict2').val(result);
        });
    });

     /* windows-registry key */
    $('#submit_output_winregkey').click(function() {
        $.ajax({
            url: '/insert_winregkey',
            data: $('#output_windows-registry-key').serialize(),
            type: 'POST',
            success: function(response) {

             //   $("#success-alert1").fadeTo(2000, 500).slideUp(500, function(){
             //  $("#success-alert1").slideUp(500);
            //    });
                $( "#success-alert3" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                $('#output_windows-registry-key').trigger("reset");
                window.location.reload();
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert3" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });

    /* x509 certificate */
    $('#submit_output_x509').click(function() {
        $.ajax({
            url: '/insert_x509',
            data: $('#output_x509-certificate').serialize(),
            type: 'POST',
            success: function(response) {

             //   $("#success-alert1").fadeTo(2000, 500).slideUp(500, function(){
             //  $("#success-alert1").slideUp(500);
            //    });
                $( "#success-alert3" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                $('#output_x509-certificate').trigger("reset");
                window.location.reload();
                console.log(response);
            },
            error: function(error) {
                $( "#error-alert3" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(error);
            }
        });

    });

    /* Insert API call*/
    $('#add_apicall').click(function() {
        $.ajax({
            url: '/insert_apicall',
            data: $('#api_callform').serialize(),
            type: 'POST',
            success: function(response) {

                  //  $("#success-alert4").fadeTo(2000, 500).slideUp(500, function(){
                   // $("#success-alert4").slideUp(500);

                //});
        $( "#success-alert4" ).fadeIn( 300 ).delay( 1500 ).fadeOut( 400 );
                console.log(response);
            },
            error: function(error) {
                $("#error-alert4").fadeTo(2000, 500).slideUp(500, function(){
               $("#error-alert4").slideUp(500);
                });
                console.log(error);
            }
        });

    });





});





